$(document).ready((function(){$("#inputarea").on("input propertychange",(function(){$.cookie("formula_format_data",$(this).val())}));$("#inputarea").val($.cookie("formula_format_data"))}));function example(e){$("#inputarea").val(e);$("#inputarea").focus();$.cookie("formula_format_data",e)}function format_work(){str=$("#inputarea").val();str=formula_formating(str);$("#result").val(str);document.getElementById("result_card").scrollIntoView({behavior:"smooth"})}function unformat_work(){str=$("#inputarea").val();str=unformula_formating(str);$("#result").val(str);document.getElementById("result_card").scrollIntoView({behavior:"smooth"})}function copy(e){let r=$.copy(e);if(r){Swal.fire({icon:"success",title:"复制成功",showConfirmButton:false,timer:2e3})}else{Swal.fire({icon:"error",title:"复制失败",html:"请手动复制您的专属代码：<code>"+oid+"</code>"})}}function formula_formating(e){function r(e){const r={0:"₀",1:"₁",2:"₂",3:"₃",4:"₄",5:"₅",6:"₆",7:"₇",8:"₈",9:"₉"};return e.split("").map((e=>r[e]||e)).join("")}function t(e){let r={2:"²",3:"³",4:"⁴",5:"⁵",6:"⁶",7:"⁷",8:"⁸",9:"⁹","+":"⁺","-":"⁻"};if(r[e]){return r[e]}else{return"&"}}let a,o;e=e.replace(/ */g,"");const n="Be,Mg,Ca,Sr,Ba,La,Ce,Pr,Nd,Pm,Sm,Eu,Gd,Tb,Dy,Ho,Er,Tm,Yb,Lu,Al,Ga,In,Tl,Si,Ge,Sn,Pb,Sc,Y,Ti,Zr,Hf,V,Nb,Ta,Cr,Mo,W,Mn,Tc,Re,Fe,Ni";a="(?<="+n.replace(/,/g,"|")+")[2-9](?=\\+)";o=new RegExp(a,"gi");e=e.replace(o,(e=>t(e)));const l="NH(?=[3-4]),NO(?=[2-3]),SO(?=[2-4]),IO(?=3),OH,CN,CH(?=[2-4]),CO,EDTA,XO,EBT,CHO,HC";a=l.replace(/,/g,"|");o=new RegExp(a,"gi");e=e.replace(o,(e=>e.toUpperCase()));const c=n+",Li,Na,Rb,Cs,Cl,Br,Be,Si";a=c.replace(/,/g,"|");o=new RegExp(a,"gi");e=e.replace(o,(e=>e.slice(0,1).toUpperCase()+e.slice(1).toLowerCase()));a="(?<="+c.replace(/,/g,"|")+")[a-z]";o=new RegExp(a,"g");e=e.replace(o,(e=>e.toUpperCase()));const i=["NO2","NO3","ClO2","ClO3","ClO4","IO3","BrO3","MnO4","HSO3","HSO4","HCO3","H2PO4","H2BO3","HSeO3","HSeO4"];let p=new RegExp(`\\b(${i.join("|")})-`,"g");e=e.replace(p,(e=>r(e)));o=/(\-|\+)(?=\+|\=|[\u4e00-\u9fa5])|(\-|\+$)/g;e=e.replace(o,(e=>t(e)));o=/[2-9](?=⁺|⁻)/g;e=e.replace(o,(e=>t(e)));o=/(?<=[a-zA-Z]|\))([2-9][0-9]*|1[0-9]+)(?![⁺⁻][=+])/g;e=e.replace(o,(e=>r(e)));e=e.replace(/\+/g," + ");e=e.replace(/=/g," = ");e=e[0].toUpperCase()+e.substr(1);e=e.replace(/(?<=[^a-zA-Z])[a-df-z]/g,(e=>e.toUpperCase()));return e}function unformula_formating(e){let r={"²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","⁺":"+","⁻":"-","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9"};let t="("+Object.keys(r).map((e=>"\\"+e)).join("|")+")";let a=new RegExp(t,"g");e=e.replace(a,(e=>r[e]));return e}