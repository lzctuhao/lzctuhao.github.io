$((function(){var e=function(e,t,r){"use strict";$.ajax({url:e,dataType:"xml",success:function(e){document.getElementById("searchLoading").remove();document.getElementById("searchInput").disabled=false;document.getElementById("searchInput").style.height="2.5em";document.getElementById("searchInput").style.opacity=1;var a=$("entry",e).map((function(){return{title:$("title",this).text(),author:$("author",this).text(),content:$("content",this).text(),url:$("url",this).text()}})).get();var n=document.getElementById(t);var s=document.getElementById(r);n.addEventListener("input",(function(){var e="";var t=this.value.trim().toLowerCase().split(/[\s\-]+/);s.innerHTML="";if(this.value.trim().length<=0){return}for(let s=0;s<a.length;s++){let g=a[s];var r=true;var n=g.title.trim().toLowerCase();var i=g.author?g.author.trim().toLowerCase():"";var l=g.content.trim().replace(/<[^>]+>/g,"").toLowerCase();var c=g.url;c=c.indexOf("/")===0?g.url:"/"+c;var u=-1;var o=-1;var f=-1;var h=-1;if(n!==""&&l!==""){t.forEach((function(e,t){u=n.indexOf(e);o=i.indexOf(e);f=l.indexOf(e);if(u<0&&o<0&&f<0){r=false}else{if(f<0){f=0}if(t===0){h=f}}}))}else continue;if(r){e+="<li><a href='"+c+"' class='search-result-title'>"+n+"</a>";if(o>-1){e+="<span class='search-result-author'><i class='fa fa-user fa-fw'></i>"+i+"</span>"}var m=g.content.trim().replace(/<[^>]+>/g,"");if(h>=0){var v=h-20;var d=h+80;if(v<0){v=0}if(v===0){d=100}if(d>m.length){d=m.length}var p=m.substr(v,d);t.forEach((function(e){var t=new RegExp(e,"gi");p=p.replace(t,'<em class="search-keyword">'+e+"</em>")}));e+='<p class="search-result">'+p+"...</p>"}e+="</li>"}}e=e==""?'<div style="margin-top:30px">没有匹配结果</div>':'<ul class="search-result-list">'+e+"</ul>";s.innerHTML=e}))}})};e("/search.xml","searchInput","searchResult")}));