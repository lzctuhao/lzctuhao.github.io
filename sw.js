(function(){function e(e,s){return function(o,t,a=s,n="inherit"){const c=`border-radius:5px; background-color: ${a}; color: white; padding:1px 5px; margin-right: 5px;`;const l=`color: ${n};`;e(`%c${o}%c${t}`,c,l)}}console.tag=e(console.log,"forestgreen");console.tag.warn=e(console.warn,"orange");console.tag.error=e(console.error,"red");console.tag.info=e(console.log,"lightblue")})();importScripts("https://cdn.jsdelivr.net/npm/workbox-sw@7.1.0/build/workbox-sw.min.js");if(workbox){console.log(`Yay! Workbox is loaded ðŸŽ‰`)}else{console.log(`Boo! Workbox didn't load ðŸ˜¬`)}self.addEventListener("activate",(e=>{e.waitUntil(self.clients.claim())}));self.addEventListener("message",(e=>{if(e.data&&e.data.type==="SKIP_WAITING"){self.skipWaiting()}}));if(workbox.navigationPreload.isSupported()){workbox.navigationPreload.enable()}const CACHE_NAME={html:"html-xml-json-cache",css_js:"css-js-cache",local_image:"local-image-cache",nonlocal:"nonlocal-cache",local_media:"local-media-cache",font:"font-cache",unsplash:"unsplash-cache"};self.addEventListener("fetch",(e=>{const s=new URL(e.request.url);console.tag("sw.js","Fetch event:"+e.request.url+"mode:"+e.request.mode);if(s.hostname==="source.unsplash.com"){console.tag("sw.js","Intercepting Unsplash request:"+e.request.url);e.respondWith(handleUnsplashRequest(e.request));return}if(e.request.mode==="navigate"){e.respondWith((async()=>{try{const s=await e.preloadResponse;if(s)return s;const o=await fetch(e.request);if(!o.ok)throw new Error("Fetch failed");return o}catch(e){console.error(e);const s=await caches.open(CACHE_NAME.html);const o=await s.match("/offline.html");return o}})())}}));async function resolveUnsplashImageUrl(e=null,s=null,o=null){const t="HDbS2nAmPx8B4FKmzLYF3FEBUhbxXTtJcTyzdQCJr3M";const a=e?`https://api.unsplash.com/photos/${e}?client_id=${t}`:`https://api.unsplash.com/photos/random?client_id=${t}`;const n=await fetch(a);if(!n.ok)throw new Error("Unsplash API failed, photoId: "+e);const c=await n.json();let l=c.urls.regular;if(s&&o){const e=new URLSearchParams({w:s,h:o,fit:"crop",crop:"faces,entropy",auto:"compress"});l+=`?${e.toString()}`}return l}async function precacheUnsplashPhoto(e,s=null,o=null){try{const t=await resolveUnsplashImageUrl(e,s,o);const a=await fetch(t);if(a.ok){const e=await caches.open("unsplash-cache");await e.put(t,a.clone());console.tag("sw.js","Precached Unsplash image:"+t)}}catch(s){console.warn("[SW] Error precaching Unsplash photo:",e,s)}}async function handleUnsplashRequest(e){const s=e.url;const o=s.match(/https:\/\/source.unsplash.com\/([-\w]+)?\/?(\d+)?x?(\d+)?/);if(!o)return fetch(e);const[t,a,n,c]=o;try{const e=await resolveUnsplashImageUrl(a,n,c);const s=await caches.open("unsplash-cache");const o=await s.match(e);if(o){console.tag("sw.js","Serving from cache:"+e);return o}const t=await fetch(e);if(t.ok){s.put(e,t.clone());console.tag("sw.js","Cached new image:"+e)}return t}catch(s){console.error("[SW] Failed to handle Unsplash request:",s);return fetch(e)}}self.addEventListener("install",(e=>{e.waitUntil((async()=>{await precacheUnsplashPhoto("iYsGZgoS6bM",800,600);await precacheUnsplashPhoto("G9i_plbfDgk",1200,800)})())}));workbox.routing.registerRoute(/\.(css|js)$/,new workbox.strategies.StaleWhileRevalidate({cacheName:CACHE_NAME.css_js,plugins:[new workbox.expiration.ExpirationPlugin({maxAgeSeconds:7*24*60*60})]}));workbox.routing.registerRoute(/(lzc|localhost:4000)\S+(\.(?:png|jpg|jpeg|svg|webp|gif))$/,new workbox.strategies.CacheFirst({cacheName:CACHE_NAME.local_image}));workbox.routing.registerRoute(/^((?!lzc|localhost).)*$/,new workbox.strategies.StaleWhileRevalidate({cacheName:CACHE_NAME.nonlocal}));workbox.routing.registerRoute(/(lzc|localhost:4000)\S+(\.(?:mp3|mp4|mkv|vtt|ogg|wav|webm))$/,new workbox.strategies.CacheFirst({cacheName:CACHE_NAME.local_media}));workbox.routing.registerRoute(/\.(?:woff2|eot|ttf|woff|otf)$/,new workbox.strategies.CacheFirst({cacheName:CACHE_NAME.font}));workbox.routing.registerRoute(/\.(?:xml|html|json)$/,new workbox.strategies.NetworkFirst({cacheName:CACHE_NAME.html}));function safeAddAll(e,s){caches.open(e).then((async e=>{for(const o of s){try{const s=await fetch(o);if(s.ok){await e.put(o,s.clone());console.tag("sw.js",`Precached: ${o}`)}else{console.tag.warn("sw.js",`Failed to fetch: ${o}`)}}catch(e){console.tag.warn("sw.js",`Error fetching: ${o}`+e)}}}))}safeAddAll(CACHE_NAME.html,["/","/offline.html","/tools/","/tools/index.html","/tools/poster/index.html","/tools/formula_format/index.html","/tools/calculator/index.html","/tools/tools-pc.html"]);const cssFiles=["/libs/materialize/materialize.min.css","/libs/sweetalert/sweetalert2.11.css","/css/matery.css","/css/matery-dark.css","/css/standalone/poster.css","/css/standalone/poster-result.css","/css/standalone/wordlist.css"];const jsFiles=["/libs/sweetalert/sweetalert2.11.js","/js/materialize.min.js","/js/matery.js","/libs/aos/aos.js","/js/standalone/jump2pc.js","/js/standalone/add2home.js","/js/standalone/calculator.js","/js/standalone/dom-to-image-more.js","/js/standalone/formula_format.js","/js/standalone/poster.js","/js/standalone/textbox_handle.js"];safeAddAll(CACHE_NAME.css_js,[...cssFiles,...jsFiles]);