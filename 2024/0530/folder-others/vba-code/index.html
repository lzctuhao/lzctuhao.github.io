<!DOCTYPE HTML><html lang="zh-CN,en,default"><head><meta charset="utf-8"><meta name="keywords" content="Code,文章页,blog"><meta name="description" content="记录一下"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta http-equiv="Access-Control-Allow-Origin" content="*"><meta name="color-scheme" content="light dark"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#c2185b"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#470024"><meta name="”apple-mobile-web-app-status-bar-style”" content="#c2185b"><meta name="”msapplication-navbutton-color”" content="#c2185b"><meta name="msapplication-TileColor" content="#c2185b"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="x5-orientation" content="portrait"><meta name="x5-fullscreen" content="true"><meta name="x5-page-mode" content="app"><meta name="full-screen" content="yes"><meta name="browsermode" content="application"><meta name="mobile-web-app-capable" content="yes"><meta itemprop="name" content="一些有用的VBA代码 | lzc的小站"><meta itemprop="image" content="/webicon.png"><meta name="description" itemprop="description" content="记录一下"><meta name="application-name" content="lzc的小站"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>一些有用的VBA代码 | lzc的小站</title><link rel="icon" type="image/png" href="/webicon.png"><link rel="apple-touch-icon" href="/webicon.png"><link rel="manifest" href="/pwa.json"><link href="/libs/awesome/css/all.min.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/css/load-dot.css"><script src="/libs/sweetalert/sweetalert2.11.js"></script><link rel="stylesheet" type="text/css" href="/libs/sweetalert/sweetalert2.11.css"><link rel="stylesheet" type="text/css" href="/libs/sweetalert/sweetalert_custom.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/libs/valine/valine-origin.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><link rel="stylesheet" type="text/css" href="/css/matery-post.css"><link rel="stylesheet" href="/libs/fancybox/fancybox.css" media="all"><link rel="stylesheet" type="text/css" href="/css/block.css"><link rel="stylesheet" type="text/css" href="/libs/codeBlock/prism-line-numbers.min.css"><link rel="stylesheet" type="text/css" href="/css/matery-code.css"><link rel="stylesheet" type="text/css" href="/libs/codeBlock/prism-one-light.css"><link rel="stylesheet" type="text/css" href="/libs/codeBlock/prism-tomorrow.css"><script src="/libs/jquery/jquery-3.7.1.min.js"></script><script defer src="/libs/aos/aos.js" onload='AOS.init({easing:"ease-in-out-sine",duration:700,delay:100})'></script><script src="/js/materialize.min.js"></script><script src="/js/matery.js"></script><script src="/js/ssl.js"></script><script src="/libs/fancybox/fancybox.umd.js"></script><script src="/js/matery-post.js"></script><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><meta name="theme-color" content="#db5945"><link rel="stylesheet" type="text/css" href="/css/matery-dark.css"><meta name="msvalidate.01" content="F30FC21E1BAC8E8C76C6D477CFFABC0F"><meta name="baidu-site-verification" content="codeva-eCdKhAiEGs"><meta name="google-adsense-account" content="ca-pub-7761188322287356"><script>navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js",{scope:"/"})</script><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/rss.xml" title="lzc的小站" type="application/rss+xml"></head><body><style>body{overflow:auto}</style><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo" id="MotherContainer"><div id="Container1"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.svg" class="logo-img hide-on-small-only" alt="Small Logo"> <span class="logo-span">lzc的小站</span></a></div><div id="Container2"><span class="logo-span">一些有用的VBA代码</span></div></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories/" class="waves-effect waves-light"><i class="fas fa-atom"></i> <span>专栏</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags/" class="waves-effect waves-light"><i class="fas fa-hashtag"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives/" class="waves-effect waves-light"><i class="fas fa-archive"></i> <span>时间轴</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about/" class="waves-effect waves-light"><i class="fas fa-info-circle"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends/" class="waves-effect waves-light"><i class="fas fa-pen-nib"></i> <span>作者</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tools/index.html?noheader=false" class="waves-effect waves-light"><i class="fas fa-tools"></i> <span>工具箱</span></a></li><li><a id="toggleSearch" href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fa-solid fa-magnifying-glass" title="搜索"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.svg" class="logo-img circle responsive-img" alt="Logo"><div class="logo-name">lzc的小站</div><div class="logo-desc">愿一切顺利，也常有诗意</div></div><ul class="menu-list mobile-menu-list"><div id="test-swipe-1" class="col s12"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/categories/" class="waves-effect waves-light"><i class="fas fa-atom"></i> 专栏</a></li><li class="m-nav-item"><a href="/tags/" class="waves-effect waves-light"><i class="fas fa-hashtag"></i> 标签</a></li><li class="m-nav-item"><a href="/archives/" class="waves-effect waves-light"><i class="fas fa-archive"></i> 时间轴</a></li><li class="m-nav-item"><a href="/about/" class="waves-effect waves-light"><i class="fas fa-info-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/friends/" class="waves-effect waves-light"><i class="fas fa-pen-nib"></i> 作者</a></li><li class="m-nav-item"><a href="/tools/index.html?noheader=false" class="waves-effect waves-light"><i class="fas fa-tools"></i> 工具箱</a></li></div></ul></div></div></div></nav></header><script>$(function(){$(".parallax").parallax()})</script><div class="post-cover bg-cover"><div class="parallax-container"><div class="parallax"><img id="bg-img" src="https://source.unsplash.com/q10VITrVYUM/800x450" alt="背景图"></div></div><div class="container cover-content"><div class="brand description center-align post-title" id="PostTitle">一些有用的VBA代码</div></div></div><main class="container content"><div id="artDetail" class="artDetail"><div class="card"><div class="card-content article-info"><div align="center" style="font-size:large"><span id="PostAuthor"><i class="far fa-square"></i> Cheuksing</span></div><div class="tag-cate"><div class="post-cate"><a href="/tags/Code/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>Code</a></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="fa-regular fa-calendar-minus"></i>2024-05-30</div><div class="post-wordCount info-break-policy"><i class="fa-regular fa-file-word"></i>文章字数: 1k</div><div class="info-break-policy"><a href="javascript:void(0);" onclick='MPost.guide_swal("记录一下")'><i class="fa-solid fa-pen-nib"></i>导读</a></div><div class="info-break-policy reprint-from"><i class="fa-regular fa-clone" aria-hidden="true"></i>转载源: 互联网</div></div></div><hr class="clearfix"><div class="card-content article-card-content"><article id="articleContent" class="articleContent"><h1 id="打开vba">打开VBA</h1><ul><li>视图-&gt;宏-&gt;查看宏</li><li>快捷键：Alt+F11</li></ul><h1 id="word">Word</h1><h2 id="监听图片粘贴并设为1倍行距">监听图片粘贴并设为1倍行距</h2><pre class="line-numbers language-visual-basic" data-language="visual-basic"><code class="language-visual-basic"><span class="token keyword">Sub</span> AutoFormatingImage<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">' 监听粘贴操作</span>
    Application<span class="token punctuation">.</span>OnTime <span class="token keyword">When</span><span class="token punctuation">:</span><span class="token operator">=</span>Now <span class="token operator">+</span> TimeValue<span class="token punctuation">(</span><span class="token string">"00:00:01"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Name<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">"CheckForPastedImage"</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span>

<span class="token keyword">Sub</span> CheckForPastedImage<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> pastedImage <span class="token keyword">As</span> InlineShape
    <span class="token comment">' 遍历文档中的所有InlineShape</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> pastedImage <span class="token keyword">In</span> ActiveDocument<span class="token punctuation">.</span>InlineShapes
        <span class="token comment">' 检查是否已经标记为Processed</span>
        <span class="token keyword">If</span> <span class="token keyword">Not</span> pastedImage<span class="token punctuation">.</span>AlternativeText <span class="token keyword">Like</span> <span class="token string">"*Processed"</span> <span class="token keyword">Then</span>
            <span class="token comment">' 设置图片所在段落的行距为1</span>
            pastedImage<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>ParagraphFormat<span class="token punctuation">.</span>LineSpacingRule <span class="token operator">=</span> wdLineSpaceSingle
            pastedImage<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>ParagraphFormat<span class="token punctuation">.</span>LineSpacing <span class="token operator">=</span> <span class="token number">12</span> <span class="token comment">' 12磅等于单倍行距</span>
            pastedImage<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>ParagraphFormat<span class="token punctuation">.</span>Alignment <span class="token operator">=</span> wdAlignParagraphCenter
            <span class="token comment">' 在原有的AlternativeText后面添加Processed标记</span>
            pastedImage<span class="token punctuation">.</span>AlternativeText <span class="token operator">=</span> pastedImage<span class="token punctuation">.</span>AlternativeText <span class="token operator">&amp;</span> <span class="token string">"Processed"</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> pastedImage
    <span class="token comment">' 继续监听下一个粘贴操作</span>
    Application<span class="token punctuation">.</span>OnTime <span class="token keyword">When</span><span class="token punctuation">:</span><span class="token operator">=</span>Now <span class="token operator">+</span> TimeValue<span class="token punctuation">(</span><span class="token string">"00:00:01"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Name<span class="token punctuation">:</span><span class="token operator">=</span><span class="token string">"CheckForPastedImage"</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="将图片转换为嵌入式">将图片转换为嵌入式</h2><pre class="line-numbers language-visual-basic" data-language="visual-basic"><code class="language-visual-basic"><span class="token keyword">Sub</span> ConvertToInlineShapeWrap<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
<span class="token keyword">Dim</span> P <span class="token keyword">As</span> Shape
<span class="token keyword">Dim</span> arr<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">Dim</span> k
k <span class="token operator">=</span> <span class="token number">0</span>
<span class="token keyword">For</span> <span class="token keyword">Each</span> P <span class="token keyword">In</span> ActiveDocument<span class="token punctuation">.</span>Shapes
    <span class="token keyword">ReDim</span> Preserve arr<span class="token punctuation">(</span>k<span class="token punctuation">)</span>
    arr<span class="token punctuation">(</span>k<span class="token punctuation">)</span> <span class="token operator">=</span> P<span class="token punctuation">.</span>Name
    k <span class="token operator">=</span> k <span class="token operator">+</span> <span class="token number">1</span>
<span class="token keyword">Next</span>
<span class="token keyword">For</span> k <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">To</span> UBound<span class="token punctuation">(</span>arr<span class="token punctuation">)</span>
    ActiveDocument<span class="token punctuation">.</span>Shapes<span class="token punctuation">(</span>arr<span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>ConvertToInlineShape
    
<span class="token keyword">Next</span>
MsgBox <span class="token string">"转换【"</span> <span class="token operator">&amp;</span> k <span class="token operator">&amp;</span> <span class="token string">"】个图片!"</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="在图注编号和正文之间添加全角空格">在图注编号和正文之间添加全角空格</h2><pre class="line-numbers language-visual-basic" data-language="visual-basic"><code class="language-visual-basic"><span class="token keyword">Sub</span> AddFullWidthSpace<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> doc <span class="token keyword">As</span> Document
    <span class="token keyword">Dim</span> fld <span class="token keyword">As</span> Field
    <span class="token keyword">Dim</span> rng <span class="token keyword">As</span> Range
    <span class="token keyword">Dim</span> fieldCode1 <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> fieldCode2 <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    <span class="token keyword">Set</span> doc <span class="token operator">=</span> ActiveDocument
    fieldCode1 <span class="token operator">=</span> <span class="token string">"SEQ 图 \* ARABIC \s 1"</span>
    fieldCode2 <span class="token operator">=</span> <span class="token string">"SEQ 表 \* ARABIC \s 1"</span>
    
    <span class="token comment">' Loop through all fields in the document</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> fld <span class="token keyword">In</span> doc<span class="token punctuation">.</span>Fields
        <span class="token keyword">Set</span> rng <span class="token operator">=</span> fld<span class="token punctuation">.</span>Code
        <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>rng<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> fieldCode1<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">Or</span> InStr<span class="token punctuation">(</span>rng<span class="token punctuation">.</span>Text<span class="token punctuation">,</span> fieldCode2<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">Then</span>
            <span class="token comment">' Move the range to the result of the field</span>
            <span class="token keyword">Set</span> rng <span class="token operator">=</span> fld<span class="token punctuation">.</span>Result
            rng<span class="token punctuation">.</span>Collapse Direction<span class="token punctuation">:</span><span class="token operator">=</span>wdCollapseEnd
            <span class="token comment">' Check if the next character is a full-width space</span>
            <span class="token keyword">If</span> <span class="token keyword">Not</span> rng<span class="token punctuation">.</span><span class="token keyword">End</span> <span class="token operator">=</span> doc<span class="token punctuation">.</span>Content<span class="token punctuation">.</span><span class="token keyword">End</span> <span class="token keyword">Then</span>
                rng<span class="token punctuation">.</span>MoveEnd wdCharacter<span class="token punctuation">,</span> <span class="token number">1</span>
                <span class="token keyword">If</span> rng<span class="token punctuation">.</span>Text <span class="token operator">&lt;</span><span class="token operator">></span> <span class="token string">"　"</span> <span class="token keyword">Then</span>
                    rng<span class="token punctuation">.</span>Collapse Direction<span class="token punctuation">:</span><span class="token operator">=</span>wdCollapseEnd
                    rng<span class="token punctuation">.</span>InsertAfter <span class="token string">"　"</span>
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token keyword">Next</span> fld
    
    <span class="token comment">' Remove multiple full-width spaces</span>
    <span class="token keyword">With</span> doc<span class="token punctuation">.</span>Content<span class="token punctuation">.</span>Find
        <span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"　&#123;2,&#125;"</span>
        <span class="token punctuation">.</span>Replacement<span class="token punctuation">.</span>Text <span class="token operator">=</span> <span class="token string">"　"</span>
        <span class="token punctuation">.</span>Forward <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Wrap <span class="token operator">=</span> wdFindContinue
        <span class="token punctuation">.</span>Format <span class="token operator">=</span> <span class="token boolean">False</span>
        <span class="token punctuation">.</span>MatchWildcards <span class="token operator">=</span> <span class="token boolean">True</span>
        <span class="token punctuation">.</span>Execute Replace<span class="token punctuation">:</span><span class="token operator">=</span>wdReplaceAll
    <span class="token keyword">End</span> <span class="token keyword">With</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="将图片后一段的题注写入替换文字">将图片（后一段的）题注写入“替换文字”</h2><pre class="line-numbers language-visual-basic" data-language="visual-basic"><code class="language-visual-basic"><span class="token comment">' 将图片后一段的题注写入“替换文字”</span>
<span class="token keyword">Sub</span> CaptionToAltText<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> doc <span class="token keyword">As</span> Document
    <span class="token keyword">Dim</span> shape <span class="token keyword">As</span> InlineShape
    <span class="token keyword">Dim</span> para <span class="token keyword">As</span> Paragraph
    <span class="token keyword">Dim</span> captionText <span class="token keyword">As</span> <span class="token keyword">String</span>
    
    <span class="token keyword">Set</span> doc <span class="token operator">=</span> ActiveDocument
    
    <span class="token keyword">For</span> <span class="token keyword">Each</span> shape <span class="token keyword">In</span> doc<span class="token punctuation">.</span>InlineShapes
        <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">Resume</span> <span class="token keyword">Next</span>
        <span class="token comment">' 获取图片下方的段落</span>
        <span class="token keyword">Set</span> para <span class="token operator">=</span> shape<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>Paragraphs<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token keyword">Next</span>
        <span class="token comment">' 检查段落是否包含图注</span>
        <span class="token keyword">If</span> para<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>Style <span class="token operator">=</span> <span class="token string">"题注"</span> <span class="token keyword">Then</span>
            captionText <span class="token operator">=</span> para<span class="token punctuation">.</span>Range<span class="token punctuation">.</span>Text
            <span class="token comment">' 去除段落标记</span>
            captionText <span class="token operator">=</span> Left<span class="token punctuation">(</span>captionText<span class="token punctuation">,</span> Len<span class="token punctuation">(</span>captionText<span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span>
            shape<span class="token punctuation">.</span>AlternativeText <span class="token operator">=</span> captionText
        <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">On</span> <span class="token keyword">Error</span> <span class="token keyword">GoTo</span> <span class="token number">0</span>
    <span class="token keyword">Next</span> shape
<span class="token keyword">End</span> <span class="token keyword">Sub</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="ppt">PPT</h1><h2 id="自动修改图注编号">自动修改图注编号</h2><p>要求：文本框为<code>图\s*\d+\s*</code>开头。</p><pre class="line-numbers language-visual-basic" data-language="visual-basic"><code class="language-visual-basic"><span class="token keyword">Sub</span> UpdateFigureNumbersAndCustomFont<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">Dim</span> sld <span class="token keyword">As</span> Slide
    <span class="token keyword">Dim</span> shp <span class="token keyword">As</span> Shape
    <span class="token keyword">Dim</span> figureNumber <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    <span class="token keyword">Dim</span> regex <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Dim</span> matches <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Dim</span> match <span class="token keyword">As</span> <span class="token keyword">Object</span>
    <span class="token keyword">Dim</span> <span class="token keyword">char</span> <span class="token keyword">As</span> TextRange
    <span class="token keyword">Dim</span> updatedCaptions <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> previousCaption <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> currentCaption <span class="token keyword">As</span> <span class="token keyword">String</span>
    <span class="token keyword">Dim</span> currentFigureNumber <span class="token keyword">As</span> <span class="token keyword">Integer</span>
    
    <span class="token keyword">Set</span> regex <span class="token operator">=</span> CreateObject<span class="token punctuation">(</span><span class="token string">"VBScript.RegExp"</span><span class="token punctuation">)</span>
    regex<span class="token punctuation">.</span><span class="token keyword">Global</span> <span class="token operator">=</span> <span class="token boolean">True</span>
    regex<span class="token punctuation">.</span>Pattern <span class="token operator">=</span> <span class="token string">"^(图\s*\d+\s*)"</span>
    
    figureNumber <span class="token operator">=</span> <span class="token number">1</span> <span class="token comment">' 初始化编号</span>
    currentFigureNumber <span class="token operator">=</span> figureNumber <span class="token comment">' 初始化当前题注的编号</span>
    updatedCaptions <span class="token operator">=</span> <span class="token string">""</span> <span class="token comment">' 初始化更新后的题注字符串</span>
    previousCaption <span class="token operator">=</span> <span class="token string">""</span> <span class="token comment">' 初始化上一个题注的文本</span>
    
    <span class="token comment">' 遍历所有幻灯片</span>
    <span class="token keyword">For</span> <span class="token keyword">Each</span> sld <span class="token keyword">In</span> ActivePresentation<span class="token punctuation">.</span>Slides
        <span class="token comment">' 遍历幻灯片上的所有形状</span>
        <span class="token keyword">For</span> <span class="token keyword">Each</span> shp <span class="token keyword">In</span> sld<span class="token punctuation">.</span>Shapes
            <span class="token comment">' 检查形状是否有文本框</span>
            <span class="token keyword">If</span> shp<span class="token punctuation">.</span>HasTextFrame <span class="token keyword">Then</span>
                <span class="token comment">' 使用正则表达式匹配文本</span>
                <span class="token keyword">Set</span> matches <span class="token operator">=</span> regex<span class="token punctuation">.</span>Execute<span class="token punctuation">(</span>shp<span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>TextRange<span class="token punctuation">.</span>text<span class="token punctuation">)</span>
                <span class="token keyword">If</span> matches<span class="token punctuation">.</span>Count <span class="token operator">></span> <span class="token number">0</span> <span class="token keyword">Then</span>
                    <span class="token keyword">Set</span> match <span class="token operator">=</span> matches<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
                    <span class="token comment">' 移除题注中的“图 x”部分</span>
                    currentCaption <span class="token operator">=</span> Replace<span class="token punctuation">(</span>shp<span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>TextRange<span class="token punctuation">.</span>text<span class="token punctuation">,</span> match<span class="token punctuation">.</span>Value<span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>
                    <span class="token comment">' 检查当前题注是否与上一个题注相同</span>
                    <span class="token keyword">If</span> currentCaption <span class="token operator">&lt;</span><span class="token operator">></span> previousCaption <span class="token keyword">Then</span>
                        <span class="token comment">' 如果不相同，更新当前题注的编号</span>
                        currentFigureNumber <span class="token operator">=</span> figureNumber
                        figureNumber <span class="token operator">=</span> figureNumber <span class="token operator">+</span> <span class="token number">1</span>
                    <span class="token keyword">End</span> <span class="token keyword">If</span>
                    <span class="token comment">' 更新编号并保留原有的文本格式</span>
                    <span class="token keyword">With</span> shp<span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>TextRange
                        <span class="token punctuation">.</span>Characters<span class="token punctuation">(</span>Start<span class="token punctuation">:</span><span class="token operator">=</span>match<span class="token punctuation">.</span>FirstIndex <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> Length<span class="token punctuation">:</span><span class="token operator">=</span>match<span class="token punctuation">.</span>Length<span class="token punctuation">)</span><span class="token punctuation">.</span>text <span class="token operator">=</span> <span class="token string">"图 "</span> <span class="token operator">&amp;</span> currentFigureNumber <span class="token operator">&amp;</span> <span class="token string">" "</span>
                        <span class="token comment">' 收集更新后的题注</span>
                        updatedCaptions <span class="token operator">=</span> updatedCaptions <span class="token operator">&amp;</span> <span class="token punctuation">.</span>text <span class="token operator">&amp;</span> vbNewLine
                        <span class="token comment">' 更新上一个题注的文本</span>
                        previousCaption <span class="token operator">=</span> currentCaption
                    <span class="token keyword">End</span> <span class="token keyword">With</span>
                    <span class="token comment">' 遍历文本框中的每个字符</span>
                    <span class="token keyword">For</span> i <span class="token operator">=</span> <span class="token number">1</span> <span class="token keyword">To</span> shp<span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>TextRange<span class="token punctuation">.</span>Length
                        <span class="token keyword">Set</span> <span class="token keyword">char</span> <span class="token operator">=</span> shp<span class="token punctuation">.</span>TextFrame<span class="token punctuation">.</span>TextRange<span class="token punctuation">.</span>Characters<span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
                        <span class="token keyword">If</span> AscW<span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">></span><span class="token operator">=</span> <span class="token number">&amp;H4E00</span> <span class="token keyword">And</span> AscW<span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span> <span class="token operator">&lt;</span><span class="token operator">=</span> <span class="token number">&amp;H9FFF</span> <span class="token keyword">Then</span>
                            <span class="token comment">' 如果字符是中文，则设置字体为“黑体”</span>
                            <span class="token keyword">char</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>NameFarEast <span class="token operator">=</span> <span class="token string">"黑体"</span>
                        <span class="token keyword">Else</span>
                            <span class="token comment">' 如果字符是英文，则设置字体为“Arial”</span>
                            <span class="token keyword">char</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Name <span class="token operator">=</span> <span class="token string">"Arial"</span>
                        <span class="token keyword">End</span> <span class="token keyword">If</span>
                        <span class="token comment">' 设置字号为14</span>
                        <span class="token keyword">char</span><span class="token punctuation">.</span>Font<span class="token punctuation">.</span>Size <span class="token operator">=</span> <span class="token number">14</span>
                    <span class="token keyword">Next</span> i
                <span class="token keyword">End</span> <span class="token keyword">If</span>
            <span class="token keyword">End</span> <span class="token keyword">If</span>
        <span class="token keyword">Next</span> shp
    <span class="token keyword">Next</span> sld
    
    <span class="token comment">' 显示成功消息和所有更新后的题注</span>
    MsgBox <span class="token string">"编号更新成功！中文字体已设置为“</span>黑体<span class="token string">”，英文字体为“</span>Arial<span class="token string">”，字号为14。以下是所有更新后的题注："</span> <span class="token operator">&amp;</span> vbNewLine <span class="token operator">&amp;</span> updatedCaptions<span class="token punctuation">,</span> vbInformation<span class="token punctuation">,</span> <span class="token string">"题注更新"</span>
<span class="token keyword">End</span> <span class="token keyword">Sub</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><link rel="stylesheet" type="text/css" href="/css/hint.min.css"></article><hr class="end_hr"><div class="reprint"><style>#artDetail .reprint *{font-size:14px!important}.reprint-tip i{width:14px}i.fa.fa-atom{padding-left:.8px}</style><p style="padding-bottom:10px"></p><p><span class="reprint-tip"><i class="fa fa-exclamation-circle"></i> 本文来源互联网， 版权归原作者<strong></strong>所有。内容仅代表原作者个人观点。如遇版权等问题，请<a style="font-size:14px" href="mailto:i@lzc2002.top?subject=版权问题&body=我在你站文章《一些有用的VBA代码》里遇到了版权问题。">联系本网</a>！</span></p></div><div id="reward" class="app1"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">感谢您的赏识</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab alihongbao-tab waves-effect waves-light"><a href="#alihongbao">看广告</a></li></ul><div id="wechat"><img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"><p>建议先扫红包码。</p><img src="/medias/reward/alihongbao.png" class="reward-img" alt="支付宝红包码"> <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="alihongbao"><p><a onclick="ad2345()">关于广告</a></p></div></div><a href="/reward.html" style="padding-bottom:15px">查看赞赏及支出记录</a></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share" class="hide-on-small-only"><div class="social-share" data-disabled="qzone, qq, weibo, douban"></div></div><script src="/libs/share/js/social-share.min.js"></script><script>window.onload=function(){/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)&&$("#article-share").hide()}</script></div></div><link rel="preconnect" href="https://apis.map.qq.com"><link rel="stylesheet" href="/libs/valine/valine-my.css" type="text/css"><div id="comments" class="card valine-card" style="margin-top:auto" data-aos="fade-up"><div style="overflow:hidden" class="card-content article-card-content"><h3 id="comments-title">发表您的看法</h3><div id="vcomments"><b>加载失败，请刷新页面。若该问题持续出现，则可能是评论区被禁用。</b></div></div></div><script src="/libs/valine/av-min.js"></script><script src="/libs/valine/iife.min.js"></script><script src="/libs/valine/Valine.min.js"></script><script>let placeholdertext;placeholdertext='推心置腹的谈话就是心灵的展示。——温·卡维林\n（本评论区无需登录，友善的评论是交流的起点！）';new Valine({el:'#vcomments',appId:'KKXPJIC2tKhiht5uCdmFR6R0-gzGzoHsz',appKey:'3C6HL2hRYTdga856HYn4V1Sw',meta:['nick','mail'],visitor:'true'==='true',recordIP:'true'==='true',avatar:'mp',pageSize:'10',lang:'en',placeholder:placeholdertext,enableQQ:'true',lang:'zh-CN',serverURLs:'https://leancloudcn.lzc2002.top'});</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fa fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2024/0605/folder-others/taobao12315/"><div class="card-image"><img src="https://source.unsplash.com/veNb0DDegzE/800x450" class="responsive-img" alt="淘宝司法渠道维权全流程记录"> <span class="card-title">淘宝司法渠道维权全流程记录</span></div></a><div class="card-content article-content"><div class="summary">背景&amp;前言 前段时间在淘宝买到了虚假宣传的充电宝，淘宝官方不予受理，最后通过法院调解渠道，满足了我的全部诉求。在此记录一下全流程。</div><div class="publish-info"><span class="publish-date"><i class="fa fa-user fa-fw"></i> Cheuksing </span><span class="publish-author"><i class="fa-regular fa-calendar-minus"></i>2024-06-05</span></div></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fa fa-chevron-right"></i></div><div class="card"><a href="/2024/0412/folder-accumulation/individual-society/alternative-treatments/"><div class="card-image"><img src="https://source.unsplash.com/iSGbjKZ9erg/750x350" class="responsive-img" alt="Alternative Treatments 替代疗法"> <span class="card-title">Alternative Treatments 替代疗法</span></div></a><div class="card-content article-content"><div class="summary">IELTS 17 Task 4</div><div class="publish-info"><span class="publish-date"><a href="/tags/%E5%B9%B2%E8%B4%A7/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>干货 </a><a href="/tags/%E5%89%91%E9%9B%85/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>剑雅 </a></span><span class="publish-author"><span class="article-tags"><a href="/categories/Writing/#Writing2" title="英语写作资料的整理。持续更新中。"><span class="chip bg-color inlineSpan">Writing</span> </a><a href="/categories/Writing/Topics/#Topics1" title="运用话题导向的模式，便于分类记忆词汇、积累句型和训练话题写作能力，使知识体系完整、层级衔接顺畅。"><span class="chip bg-color inlineSpan">Topics</span> </a><a href="/categories/Writing/Topics/Individual-Society/#Individual &amp; Society1"><span class="chip bg-color inlineSpan">Individual & Society</span></a></span></span></div></div></div></div></div></article></div><style>.article-info .col.s6{width:100%}</style><script defer type="text/javascript" src="/libs/codeBlock/codeBlockFunction.js"></script><script defer type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script defer type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script defer type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script><script src="/libs/s2t/jquery.s2t.js"></script><script>MPost.search_author("","https://proxy1.lzc2002.top/http/https://zh.wikipedia.org")</script></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"><div class="footerCDN app1 hide-on-small-only"><b><a class="footerCDN inlineSpan" href="https://www.lzc2002.top/2024/0530/folder-others/vba-code/"><svg t="1651370553750" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1782" width="200" height="200"><path d="M512 96l480 832H32z" p-id="1783"></path></svg> 线路1(推荐) </a></b><a class="footerCDN inlineSpan" href="https://lzctuhao.4everland.app/2024/0530/folder-others/vba-code/"><img src="/medias/icons/4everland.png" alt="4everland"> <svg t="1651370711138" class="icon" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16776" width="200" height="200"><path d="M815.812 639.826l-461.6-5.856a9.16 9.16 0 0 1-7.264-3.852 9.296 9.296 0 0 1-0.988-8.294 12.286 12.286 0 0 1 10.722-8.152l465.88-5.872c55.262-2.52 115.092-47.148 136.044-101.568l26.572-69.084a15.888 15.888 0 0 0 1.048-5.872 15.47 15.47 0 0 0-0.328-3.262A303.82 303.82 0 0 0 402.514 396.8 136.24 136.24 0 0 0 188.4 539.18C83.848 542.212 0 627.456 0 732.24a192.108 192.108 0 0 0 2.058 27.916 9.016 9.016 0 0 0 8.89 7.742l852.2 0.102c0.086 0 0.16-0.038 0.244-0.04a11.212 11.212 0 0 0 10.542-8l6.546-22.53c7.8-26.8 4.896-51.6-8.2-69.8-12.032-16.784-32.1-26.656-56.468-27.804z m211.9-197.626c-4.282 0-8.542 0.124-12.782 0.328a7.542 7.542 0 0 0-6.648 5.306l-18.154 62.386c-7.8 26.8-4.898 51.572 8.2 69.78 12.04 16.8 32.108 26.646 56.476 27.8l98.4 5.878a8.982 8.982 0 0 1 7.02 3.788 9.28 9.28 0 0 1 1.028 8.338 12.306 12.306 0 0 1-10.702 8.15l-102.25 5.878c-55.508 2.54-115.338 47.148-136.29 101.568l-7.39 19.212a5.432 5.432 0 0 0 4.854 7.36c0.092 0 0.176 0.034 0.272 0.034h351.82a9.38 9.38 0 0 0 9.078-6.74 249.614 249.614 0 0 0 9.364-68C1280 554.6 1167.048 442.2 1027.712 442.2z" p-id="16777"></path></svg> 线路2 </a><a class="footerCDN inlineSpan" href="https://lzc.vercel.app/2024/0530/folder-others/vba-code/"><svg t="1651370553750" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1782" width="200" height="200"><path d="M512 96l480 832H32z" p-id="1783"></path></svg> 线路3 </a><a class="footerCDN inlineSpan" href="https://lzc2002.netlify.app/2024/0530/folder-others/vba-code/"><svg t="1651370594034" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15624" width="200" height="200"><path d="M722.517333 363.477333a44.544 44.544 0 0 1 12.928 9.813334l100.224-44.586667-93.525333-92.629333-20.949333 126.037333zM514.56 279.296a55.68 55.68 0 0 1 8.917333 24.490667l149.205334 63.232a44.544 44.544 0 0 1 15.146666-7.552l24.490667-151.466667-90.88-95.317333-106.88 164.352v2.261333z m509.141333 234.282667l-159.914666-159.914667-108.714667 44.544 267.264 113.578667s2.261333 1.792 1.365333 1.792z m-26.752 25.856l-256.554666-109.610667a44.544 44.544 0 0 1-29.866667 17.365333l-27.605333 168.832a44.544 44.544 0 0 1 12.928 31.189334l155.008 32.512 142.08-141.226667v-2.645333zM657.066667 394.666667l-139.434667-59.306667a51.2 51.2 0 0 1-44.544 23.168h-8.490667L349.226667 536.746667l308.266666-133.632v0.426666a37.845333 37.845333 0 0 1 0-7.125333 2.218667 2.218667 0 0 0-0.426666-1.749333z m169.258666 311.808l-136.32-28.074667a46.762667 46.762667 0 0 1-19.626666 14.677333l-32.469334 201.386667 189.312-187.562667s-0.426667 0.853333-0.896 0.853334z m-190.677333-13.824a44.544 44.544 0 0 1-26.282667-30.293334l-253.866666-52.138666-3.584 5.802666 230.314666 333.226667 13.781334-13.824 39.210666-241.92s1.322667 0.938667 0.426667 0.469333z m-274.816-113.152l250.794667 51.669333a44.544 44.544 0 0 1 35.157333-22.272l27.178667-166.144-5.76-4.906667-311.808 133.632a77.525333 77.525333 0 0 1 4.437333 8.021334z m-105.130667 41.856l-5.333333-5.333334-108.245333 44.544 52.565333 52.138667 59.690667-92.672z m71.253334 16.938666a58.368 58.368 0 0 1-24.021334 5.333334 59.264 59.264 0 0 1-19.2-3.114667l-65.877333 95.786667 288.64 285.952 50.773333-50.346667z m-40.533334-112.682666a72.618667 72.618667 0 0 1 13.397334 0 58.794667 58.794667 0 0 1 14.677333 0l116.693333-181.333334a50.773333 50.773333 0 0 1-14.250666-35.157333 52.992 52.992 0 0 1 0-11.562667l-141.653334-65.493333-114.005333 110.933333z m12.928-315.818667l138.112 58.794667a52.992 52.992 0 0 1 35.626667-12.032 57.898667 57.898667 0 0 1 16.938667 2.688l107.776-168.405334L508.714667 1.749333 299.349333 207.104s-0.426667 2.218667 0 2.688z m-51.626666 348.330667a66.816 66.816 0 0 1 10.24-14.250667L139.861333 367.488 0 503.338667l247.637333 54.784z m-11.178667 29.866666L22.741333 543.36l93.994667 95.36 118.485333-50.346667z" p-id="15625"></path></svg> 线路4 </a><span class="inlineSpan"><a class="footerCDN inlineSpan" href="https://gh.lzc2002.gq/2024/0530/folder-others/vba-code/"><svg t="1651370627500" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16590" width="200" height="200"><path d="M511.957333 21.333333C241.024 21.333333 21.333333 240.981333 21.333333 512c0 216.832 140.544 400.725333 335.573334 465.664 24.490667 4.394667 32.256-10.069333 32.256-23.082667 0-11.690667 0.256-44.245333 0-85.205333-136.448 29.610667-164.736-64.64-164.736-64.64-22.314667-56.704-54.4-71.765333-54.4-71.765333-44.586667-30.464 3.285333-29.824 3.285333-29.824 49.194667 3.413333 75.178667 50.517333 75.178667 50.517333 43.776 75.008 114.816 53.333333 142.762666 40.789333 4.522667-31.658667 17.152-53.376 31.189334-65.536-108.970667-12.458667-223.488-54.485333-223.488-242.602666 0-53.546667 19.114667-97.322667 50.517333-131.669334-5.034667-12.330667-21.930667-62.293333 4.778667-129.834666 0 0 41.258667-13.184 134.912 50.346666a469.802667 469.802667 0 0 1 122.88-16.554666c41.642667 0.213333 83.626667 5.632 122.88 16.554666 93.653333-63.488 134.784-50.346667 134.784-50.346666 26.752 67.541333 9.898667 117.504 4.864 129.834666 31.402667 34.346667 50.474667 78.122667 50.474666 131.669334 0 188.586667-114.730667 230.016-224.042666 242.090666 17.578667 15.232 33.578667 44.672 33.578666 90.453334v135.850666c0 13.141333 7.936 27.605333 32.853334 22.869334C862.250667 912.597333 1002.666667 728.746667 1002.666667 512 1002.666667 240.981333 783.018667 21.333333 511.957333 21.333333z" p-id="16591"></path></svg> 线路5 </a><a class="footerCDN inlineSpan" href="https://www.lzc2002.gq/2024/0530/folder-others/vba-code/"><img src="/medias/icons/4everland.png" alt="4everland"> <svg t="1651370711138" class="icon" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16776" width="200" height="200"><path d="M815.812 639.826l-461.6-5.856a9.16 9.16 0 0 1-7.264-3.852 9.296 9.296 0 0 1-0.988-8.294 12.286 12.286 0 0 1 10.722-8.152l465.88-5.872c55.262-2.52 115.092-47.148 136.044-101.568l26.572-69.084a15.888 15.888 0 0 0 1.048-5.872 15.47 15.47 0 0 0-0.328-3.262A303.82 303.82 0 0 0 402.514 396.8 136.24 136.24 0 0 0 188.4 539.18C83.848 542.212 0 627.456 0 732.24a192.108 192.108 0 0 0 2.058 27.916 9.016 9.016 0 0 0 8.89 7.742l852.2 0.102c0.086 0 0.16-0.038 0.244-0.04a11.212 11.212 0 0 0 10.542-8l6.546-22.53c7.8-26.8 4.896-51.6-8.2-69.8-12.032-16.784-32.1-26.656-56.468-27.804z m211.9-197.626c-4.282 0-8.542 0.124-12.782 0.328a7.542 7.542 0 0 0-6.648 5.306l-18.154 62.386c-7.8 26.8-4.898 51.572 8.2 69.78 12.04 16.8 32.108 26.646 56.476 27.8l98.4 5.878a8.982 8.982 0 0 1 7.02 3.788 9.28 9.28 0 0 1 1.028 8.338 12.306 12.306 0 0 1-10.702 8.15l-102.25 5.878c-55.508 2.54-115.338 47.148-136.29 101.568l-7.39 19.212a5.432 5.432 0 0 0 4.854 7.36c0.092 0 0.176 0.034 0.272 0.034h351.82a9.38 9.38 0 0 0 9.078-6.74 249.614 249.614 0 0 0 9.364-68C1280 554.6 1167.048 442.2 1027.712 442.2z" p-id="16777"></path></svg> 线路6</a></span><br></div><div>本站由 Cheuksing 基于 Hexo 搭建</div><div id="beian" class="beian_all"><a target="_blank" href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011502001113" class="beian mps"><img src="/medias/icons/beian.png"><span>粤公网安备 44011502001113号</span></a> <span style="width:15px"></span> <a target="_blank" href="https://beian.miit.gov.cn/" class="beian web"><span class="inlineSpan">粤ICP备2023073334号-1</span></a> <span style="width:15px"></span> <a target="_blank" href="https://beian.miit.gov.cn/" class="beian androidapp"><span class="inlineSpan">粤ICP备2023073334号-2A</span></a> <span style="width:15px"></span> <a target="_blank" href="https://appgallery.huawei.com/app/C107620695" class="beian quickapp"><span class="inlineSpan">粤ICP备2023073334号-3K</span></a></div></div><div class="col s12 m4 l4 social-link"><a href="mailto:lzctuhao@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope"></i> </a><a href="https://twitter.com/lzctuhao" class="tooltipped" target="_blank" data-tooltip="Twitter ID: lzctuhao" data-position="top" data-delay="50"><i class="fab fa-twitter"></i> </a><a href="/rss.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i> </a><a href="javascript:;" class="tooltipped" data-tooltip="微信公众号：<b>lzc的碎碎念</b>" data-position="top" data-delay="50" onclick="wechat_account()"><i class="fab fa-weixin"></i></a></div></div></footer><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0c8b78484a4be26ff40b093482b3fb88";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-F0KM6K165P"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-F0KM6K165P")</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-7761188322287356" crossorigin="anonymous"></script><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" disabled></div><div id="searchLoading"><img src="/medias/loading/loading-dna.svg" attribute="loading" alt="搜索索引正在加载中"><div>搜索索引正在加载中</div></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><div id="backTop" class="top-scroll" title="回顶部"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-angle-double-up"></i></a></div><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script></body></html>