<!DOCTYPE HTML><html lang="zh-CN,en,default"><head><meta charset="utf-8"><meta name="keywords" content="Code,文章页,blog"><meta name="description" content="R语言分析α、β多样性代码"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta http-equiv="Access-Control-Allow-Origin" content="*"><meta name="color-scheme" content="light dark"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#c2185b"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#470024"><meta name="”apple-mobile-web-app-status-bar-style”" content="#c2185b"><meta name="”msapplication-navbutton-color”" content="#c2185b"><meta name="msapplication-TileColor" content="#c2185b"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="x5-orientation" content="portrait"><meta name="x5-fullscreen" content="true"><meta name="x5-page-mode" content="app"><meta name="full-screen" content="yes"><meta name="browsermode" content="application"><meta name="mobile-web-app-capable" content="yes"><meta itemprop="name" content="R语言分析α、β多样性 | lzc的小站"><meta itemprop="image" content="/webicon.png"><meta name="description" itemprop="description" content="R语言分析α、β多样性代码"><meta name="application-name" content="lzc的小站"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no"><title>R语言分析α、β多样性 | lzc的小站</title><link rel="icon" type="image/png" href="/webicon.png"><link rel="apple-touch-icon" href="/webicon.png"><link rel="manifest" href="/pwa.json"><link href="/libs/awesome/css/all.min.css" rel="stylesheet"><link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="/css/load-dot.css"><script src="/libs/sweetalert/sweetalert2.11.js"></script><link rel="stylesheet" type="text/css" href="/libs/sweetalert/sweetalert2.11.css"><link rel="stylesheet" type="text/css" href="/css/matery.css"><link rel="stylesheet" type="text/css" href="/css/matery-mathjax.css"><link rel="stylesheet" type="text/css" href="/libs/valine/valine-origin.css"><link rel="stylesheet" type="text/css" href="/css/my.css"><link rel="stylesheet" type="text/css" href="/css/matery-post.css"><link rel="stylesheet" href="/libs/fancybox/fancybox.css" media="all"><link rel="stylesheet" type="text/css" href="/css/block.css"><link rel="stylesheet" type="text/css" href="/libs/codeBlock/prism-line-numbers.min.css"><link rel="stylesheet" type="text/css" href="/css/matery-code.css"><link rel="stylesheet" type="text/css" href="/libs/codeBlock/prism-one-light.css"><link rel="stylesheet" type="text/css" href="/libs/codeBlock/prism-tomorrow.css"><script src="/libs/jquery/jquery-3.7.1.min.js"></script><script defer src="/libs/aos/aos.js" onload='AOS.init({easing:"ease-in-out-sine",duration:700,delay:100})'></script><script src="/js/materialize.min.js"></script><script src="/js/matery.js"></script><script src="/js/ssl.js"></script><script src="/libs/fancybox/fancybox.umd.js"></script><script src="/js/matery-post.js"></script><script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script><script src="/libs/tocbot/tocbot.min.js"></script><script src="/js/toc.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js?config=TeX-AMS-MML_HTMLorMML" id="MathJax-script"></script><script>const mathjax_config={
                    tex2jax: {
                        inlineMath: [['\\\(', '\\\)'],['$','$']],
                        displayMath: [["\\\[","\\\]"],['$$','$$']],
                        processEscapes: true, //https://docs.mathjax.org/en/v2.7-latest/options/preprocessors/tex2jax.html
                        processClass: "ztext-math|math"
                    },
                    TeX: {
                        extensions: ["color.js"]
                    },
                    "HTML-CSS": {
                        //showMathMenu: true, 
                        scale: 85,
                        linebreaks: {automatic: true},
                    },
                    /*
                    SVG: {linebreaks:{automatic: true},scale: 100,blacker:3},*/
                    showMathMenu: false,//右击菜单显示
                    showProcessingMessages: true,    //加载时候左下角加载情况的展示
                    messageStyle: "simple"
                }
                MathJax.Hub.Config(mathjax_config);
            
                MathJax.Hub.Register.StartupHook("End",function () {
                    mathjax_ready&&mathjax_ready();//在head.ejs
                    $("#loading-cover").fadeOut(500);
                })</script><script>function mathjax_ready(){}</script><meta name="theme-color" content="#db5945"><link rel="stylesheet" type="text/css" href="/css/matery-dark.css"><meta name="msvalidate.01" content="F30FC21E1BAC8E8C76C6D477CFFABC0F"><script>navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js",{scope:"/"})</script><script>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?0c8b78484a4be26ff40b093482b3fb88";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script><meta name="generator" content="Hexo 7.0.0"><link rel="alternate" href="/rss.xml" title="lzc的小站" type="application/rss+xml">
</head><body><div id="loading-cover"><div id="loading-cover-content"><div class="lds-css ng-scope"><div style="width:100%;height:100%" class="lds-ellipsis"><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div><div><div></div></div></div></div><p style="margin:0 auto">即将为您呈现《R语言分析α、β多样性》</p></div><div id="load-info">正在加载数学插件或排版插件</div></div><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="container"><div class="nav-wrapper"><div class="brand-logo" id="MotherContainer"><div id="Container1"><a href="/" class="waves-effect waves-light"><img src="/medias/logo.svg" class="logo-img hide-on-small-only" alt="Small Logo"> <span class="logo-span">lzc的小站</span></a></div><div id="Container2"><span class="logo-span">R语言分析α、β多样性</span></div></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"> <?xml version="1.0" encoding="utf-8"?> <svg class="toctoggle" version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 522 512" style="enable-background:new 0 0 522 512" xml:space="preserve"><style type="text/css">.st0{fill:none;stroke:#000;stroke-width:15;stroke-linecap:round;stroke-miterlimit:10}.st1{fill:none}</style><line class="st0" x1="338.4" y1="8.3" x2="129.6" y2="503.7"/><path class="st1" d="M565.1,426.7c11.5,0,20.7-9.2,20.7-20.7c0-11.5-9.2-20.7-20.7-20.7H400.8l-17.5,41.5H565.1z"/><path class="st1" d="M351.1,405.9c0,11.5,9.2,20.7,20.7,20.7h11.6l17.5-41.5h-29C360.3,385.2,351.1,394.4,351.1,405.9z"/><path class="st1" d="M351.1,323c0,11.5,9.2,20.7,20.7,20.7h46.5l17.5-41.5h-64C360.3,302.3,351.1,311.5,351.1,323z"/><path class="st1" d="M351.1,240.1c0,11.5,9.2,20.7,20.7,20.7h81.4l17.5-41.5h-98.9C360.3,219.3,351.1,228.6,351.1,240.1z"/><path class="st1" d="M565.1,343.7c11.5,0,20.7-9.2,20.7-20.7s-9.2-20.7-20.7-20.7H435.7l-17.5,41.5H565.1z"/><path class="st1" d="M565.1,260.8c11.5,0,20.7-9.2,20.7-20.7s-9.2-20.7-20.7-20.7h-94.4l-17.5,41.5H565.1z"/><ellipse class="st1" cx="288.9" cy="240.1" rx="27.6" ry="27.6"/><ellipse class="st1" cx="288.9" cy="405.9" rx="27.6" ry="27.6"/><ellipse class="st1" cx="288.9" cy="323" rx="27.6" ry="27.6"/><path d="M415.4,80.2H303.7l-37.8,89.8h94.4c11.5,0,20.7,9.2,20.7,20.7s-9.2,20.7-20.7,20.7H248.4L230.9,253h129.3
        c11.5,0,20.7,9.2,20.7,20.7s-9.2,20.7-20.7,20.7H213.4L196,335.9h164.3c11.5,0,20.7,9.2,20.7,20.7c0,11.5-9.2,20.7-20.7,20.7H178.5
        l-37.8,89.8h274.8c30.5,0,55.2-24.8,55.2-55.3V135.5C470.7,105,445.9,80.2,415.4,80.2z"/><g><path d="M70.7,162C57,162,46,173.1,46,186.7s11,24.7,24.7,24.7H249l20.8-49.3H70.7z"/><path d="M46,310.1c0,13.6,11,24.7,24.7,24.7H197l20.8-49.3H70.7C57,285.4,46,296.4,46,310.1z"/><path d="M70.7,38.7C57,38.7,46,49.7,46,63.3C46,77,57,88,70.7,88h230.3l20.8-49.3H70.7z"/></g></svg></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories/" class="waves-effect waves-light"><i class="fas fa-atom"></i> <span>专栏</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags/" class="waves-effect waves-light"><i class="fas fa-hashtag"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/archives/" class="waves-effect waves-light"><i class="fas fa-archive"></i> <span>时间轴</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about/" class="waves-effect waves-light"><i class="fas fa-info-circle"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/friends/" class="waves-effect waves-light"><i class="fas fa-pen-nib"></i> <span>作者</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tools/index.html?noheader=false" class="waves-effect waves-light"><i class="fas fa-tools"></i> <span>工具箱</span></a></li><li><a id="toggleSearch" href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fa-solid fa-magnifying-glass" title="搜索"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="/medias/logo.svg" class="logo-img circle responsive-img" alt="Logo"><div class="logo-name">lzc的小站</div><div class="logo-desc">愿一切顺利，也常有诗意</div></div><ul class="menu-list mobile-menu-list"><ul id="tabs-swipe-demo" class="tabs"><li class="tab col s3"><a href="#test-swipe-1"><i class="fas fa-bars"></i>菜单</a></li><li class="tab col s3"><a class="active" href="#test-swipe-2"><i class="fa-regular fa-rectangle-list"></i>目录</a></li></ul><style></style><div id="test-swipe-1" class="col s12"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/categories/" class="waves-effect waves-light"><i class="fas fa-atom"></i> 专栏</a></li><li class="m-nav-item"><a href="/tags/" class="waves-effect waves-light"><i class="fas fa-hashtag"></i> 标签</a></li><li class="m-nav-item"><a href="/archives/" class="waves-effect waves-light"><i class="fas fa-archive"></i> 时间轴</a></li><li class="m-nav-item"><a href="/about/" class="waves-effect waves-light"><i class="fas fa-info-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/friends/" class="waves-effect waves-light"><i class="fas fa-pen-nib"></i> 作者</a></li><li class="m-nav-item"><a href="/tools/index.html?noheader=false" class="waves-effect waves-light"><i class="fas fa-tools"></i> 工具箱</a></li></div><div id="test-swipe-2" class="col s12"><div id="toc-content-mobile-father" class="toc-widget"><a id="toc-content-mobile" class="toctriangle toc-content" href="javascript:MPost.toc_init()">点击加载目录</a></div></div></ul></div></div></div></nav></header><script>$(function(){$(".parallax").parallax()})</script><div class="post-cover bg-cover"><div class="parallax-container"><div class="parallax"><img id="bg-img" src="https://source.unsplash.com/xG02JzIBf7o/800x450" alt="背景图"></div></div><div class="container cover-content"><div class="brand description center-align post-title" id="PostTitle">R语言分析α、β多样性</div></div></div><main class="post-container content"><link rel="stylesheet" href="/libs/tocbot/tocbot.css"><link rel="stylesheet" href="/css/matery-toc.css"><div class="row"><div class="col s12 m12 l9"><div id="artDetail" class="artDetail mathjax hastoc font-serif"><div class="card"><div class="card-content article-info"><div align="center" style="font-size:large"><span id="PostAuthor"><i class="far fa-square"></i> Cheuksing</span></div><div class="tag-cate"><div class="post-cate"><a href="/tags/Code/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>Code</a></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="fa-regular fa-calendar-minus"></i>2024-03-14</div><div class="post-wordCount info-break-policy"><i class="fa-regular fa-file-word"></i>文章字数: 5.1k</div><div class="info-break-policy"><a href="javascript:void(0);" onclick='MPost.guide_swal("R语言分析α、β多样性代码")'><i class="fa-solid fa-pen-nib"></i>导读</a></div><div class="info-break-policy reprint-from"></div></div></div><hr class="clearfix"><div class="card-content article-card-content"><article id="articleContent" class="articleContent"><h1 id="α多样性">α多样性</h1><p>Alpha多样性（α多样性）是指在特定生境或生态系统内部的物种多样性。它通常包括两个方面：物种丰富度（种类的数量）和物种均匀度（物种分布的均匀性）。α多样性的测量可以帮助我们了解一个生态系统的复杂性和生物群落的健康状况。</p><p>以下是一些常用的α多样性指数及其作用和异同：</p><ul><li><p><strong>Shannon指数</strong>:</p><ul><li>综合考虑了物种的丰富度和均匀度。</li><li>值越高，表明群落的多样性越高。</li><li>计算公式为 <span class="math inline">\(H = -\sum (p_i \ln p_i)\)</span>，其中<span class="math inline">\(( p_i )\)</span>是第<span class="math inline">\(i\)</span>个物种的相对丰度。</li></ul></li><li><p><strong>Richness</strong>:</p><ul><li>简单地衡量生态群落中物种的数量。</li><li>不考虑物种的丰度或其分布。</li></ul></li><li><p><strong>Pielou均匀度指数</strong>:</p><ul><li>衡量物种分布均匀度的指标。</li><li>计算公式为 <span class="math inline">\(E = H / \ln(S)\)</span>，其中<span class="math inline">\(H\)</span>是Shannon指数，<span class="math inline">\(S\)</span>是物种数。</li></ul></li><li><p><strong>Simpson指数</strong>:</p><ul><li><p>衡量物种丰富度，但考虑物种的丰度权重。</p></li><li><p>值越大，多样性越低（因为它实际上计算的是均匀度的倒数）。</p></li><li><p>计算公式为 <span class="math inline">\(D=∑(n_i/N)^2\)</span></p><p>，其中( n_i )是第i个物种的个体数，N是群落中个体的总数。</p></li></ul></li><li><p><strong>Chao1指数</strong>:</p><ul><li>估计群落中未被观察到的物种丰富度。</li><li>特别适用于样本中有很多稀有物种的情况。</li></ul></li></ul><p>这些指数的主要区别在于它们考虑的多样性方面不同。例如，Shannon和Simpson指数都考虑了物种的丰富度和均匀度，但Shannon更强调均匀度，而Simpson更强调丰富度。Pielou均匀度指数专注于物种分布的均匀性，而Chao1则用于估计可能未被检测到的物种的数量。这些指数通常结合使用，以提供关于生态群落多样性的更全面的视图。</p><p>通过下列代码可以绘制α多样性相关指数图：</p><pre class="line-numbers language-R" data-language="R"><div class="caption"><span>alpha_group.r</span></div><code class="language-R">rm(list &#x3D; ls())

## 加载必要的包
library(vegan)
library(ggplot2)
library(reshape2)
library(patchwork)

## 读入数据并进行转置
otu &lt;- read.table(&quot;final_resample_otu_table_sediment_taxa.csv&quot;, sep &#x3D; &quot;,&quot;, header &#x3D; TRUE, row.names &#x3D; 1)
otu &lt;- otu[ , -ncol(otu)]  # 移除taxa列
otu &lt;- t(otu)

## 假设每个样本的组信息存储在数据行名中
groups &lt;- sub(&quot;_.*&quot;, &quot;&quot;, rownames(otu))  # 从行名中提取组信息，例如 &quot;D151_2&quot; -&gt; &quot;D151&quot;

## 计算丰富度、Shannon 指数、Simpson 指数、Pielou 均匀度、Chao1 指数、ACE 指数、goods_coverage 指数
alpha &lt;- function(x, base &#x3D; exp(1)) &#123;
  est &lt;- estimateR(x)
  Richness &lt;- est[1, ]
  Chao1 &lt;- est[2, ]
  ACE &lt;- est[4, ]
  Shannon &lt;- diversity(x, index &#x3D; &quot;shannon&quot;, base &#x3D; base)
  Simpson &lt;- diversity(x, index &#x3D; &quot;simpson&quot;)
  Pielou &lt;- Shannon &#x2F; log(Richness, base)
  goods_coverage &lt;- 1 - rowSums(x &#x3D;&#x3D; 1) &#x2F; rowSums(x)
  
  result &lt;- data.frame(SITE &#x3D; rownames(x), GROUP &#x3D; groups, Richness, Shannon, Simpson, Pielou, Chao1, ACE, goods_coverage)
  colnames(result) &lt;- c(&quot;SITE&quot;, &quot;GROUP&quot;, &quot;RICHNESS&quot;, &quot;SHANNON&quot;, &quot;SIMPSON&quot;, &quot;PIELOU&quot;, &quot;CHAO1&quot;, &quot;ACE&quot;, &quot;GOODS_COVERAGE&quot;)
  result
&#125;

alpha_all &lt;- alpha(otu, base &#x3D; 2)

## 保存为 CSV 文件
write.csv(alpha_all, file &#x3D; &quot;alpha_all.csv&quot;, row.names &#x3D; FALSE, quote &#x3D; FALSE)

## 绘制各指数箱线图
indices &lt;- c(&quot;SHANNON&quot;, &quot;RICHNESS&quot;, &quot;PIELOU&quot;, &quot;SIMPSON&quot;, &quot;CHAO1&quot;)

# 创建一个空列表来存储图形对象
plots &lt;- list()

# 使用循环创建每个指数的箱线图
for (i in seq_along(indices)) &#123;
  index &lt;- indices[i]
  data_melted &lt;- melt(alpha_all, id.vars &#x3D; c(&quot;GROUP&quot;, &quot;SITE&quot;), measure.vars &#x3D; index)
  colnames(data_melted)[which(colnames(data_melted) &#x3D;&#x3D; &quot;value&quot;)] &lt;- &quot;value&quot;
  p &lt;- ggplot(data_melted, aes(x &#x3D; GROUP, y &#x3D; value, fill &#x3D; GROUP)) +
    geom_boxplot() +
    labs(x &#x3D; paste(index, &quot;Index&quot;), y &#x3D; &quot;&quot;) +
    theme_bw() +
    theme(axis.text.x &#x3D; element_blank())
  if (i &#x3D;&#x3D; length(indices)) &#123;
    p &lt;- p + labs(fill &#x3D; &quot;Group&quot;) # 仅在最后一个图表上添加图例
  &#125; else &#123;
    p &lt;- p + guides(fill &#x3D; FALSE) # 隐藏其余图表的图例
  &#125;
  plots[[index]] &lt;- p
&#125;

# 使用patchwork将所有图表组合成一个1行5列的布局
p_combined &lt;- wrap_plots(plots, ncol &#x3D; 5)

# 保存图像
ggsave(paste0(&#39;alpha_all_&#39;, &quot;Alpha_Diversity&quot;, &#39;.svg&#39;), p_combined, width &#x3D; 6 * 0.6 * 5, height &#x3D; 6)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>其中，<code>alpha_all.csv</code>的格式如：</p><pre class="language-csv" data-language="csv"><div class="caption"><span>alpha_all.csv</span></div><code class="language-csv"><span class="token value">SITE	GROUP	RICHNESS	SHANNON	SIMPSON	PIELOU	CHAO1	ACE	GOODS_COVERAGE</span>
<span class="token value">D151_2	Raw	456	5.985928225	0.966626149	0.677686263	908.7631579	921.6164037	0.994927596</span></code></pre><p>结果图：</p><p><img src="alpha_all_Alpha_Diversity.svg"></p><h1 id="β多样性">β多样性</h1><h2 id="基于otu表">基于OTU表</h2><pre class="line-numbers language-R" data-language="R"><div class="caption"><span>PCOA_bray&jaccard.R</span></div><code class="language-R">library(vegan)
library(ape)
library(ggplot2)
library(grid)
library(ggalt)
library(dplyr)
library(multcomp)
library(patchwork)
library(xlsx)
rm(list &#x3D; ls())

galaxy &lt;- &quot;33&quot;
method &lt;-&quot;jaccard&quot; #https:&#x2F;&#x2F;rdocumentation.org&#x2F;packages&#x2F;vegan&#x2F;versions&#x2F;2.6-4&#x2F;topics&#x2F;vegdist #bray jaccard

groups &lt;- read.xlsx2(&quot;Group3233.xlsx&quot;, sheetName &#x3D;galaxy, row.names&#x3D;1)
Legend_column &lt;- &quot;Group&quot; #分组依据是csv中的哪一列
output_url &lt;- paste0(&quot;Galaxy&quot;,galaxy,&quot;-PCoA-&quot;,method)
data &#x3D; read.table(paste0(&quot;Galaxy&quot;,galaxy,&quot;.csv&quot;), header&#x3D;T, row.names&#x3D;1, sep&#x3D;&quot;,&quot;)
data&#x3D;t(data)#每行为一个样品

#在otu和gp中删除Legend_column为空的行
# empty_rows &lt;- which( (is.na(groups[[paste0(Legend_column)]])) | (groups[[paste0(Legend_column)]]&#x3D;&#x3D;&quot;&quot;) )
# groups &lt;- groups[-empty_rows,]
# data &lt;- data[-empty_rows,]
# rm(empty_rows)
# groups&#x3D;subset(groups, select &#x3D; c(paste0(Legend_column),&quot;Mark&quot;))#只保留所需列

#只保留某些mark，此段代码选择启用
# rows &lt;- c(&quot;G52&quot;,&quot;C52&quot;,&quot;Raw&quot;)
# remain_rows &lt;- which( groups[[&quot;Mark&quot;]] %in% rows )
# groups &lt;- groups[remain_rows,]
# data &lt;- data[remain_rows,]
# rm(remain_rows)

length&#x3D;nrow(groups)
times1&#x3D;length
res1&#x3D;length
times2&#x3D;length
res2&#x3D;length
col1&#x3D;rep(1:8,times1)
col&#x3D;c(col1,1:res1)
pich1&#x3D;rep(c(21:24),times2)
pich&#x3D;c(pich1,15:(15+res2))

data &lt;- vegdist(data, method &#x3D; method)
pcoa&lt;- pcoa(data, correction &#x3D; &quot;none&quot;, rn &#x3D; NULL)
PC1 &#x3D; pcoa$vectors[,1]
PC2 &#x3D; pcoa$vectors[,2]
plotdata &lt;- data.frame(rownames(pcoa$vectors),PC1,PC2,groups)
colnames(plotdata)[1:3] &lt;-c(&quot;sample&quot;,&quot;PC1&quot;,&quot;PC2&quot;) #重命名1~3列
names(plotdata)[names(plotdata) &#x3D;&#x3D; paste0(Legend_column)] &lt;- &#39;Group&#39; #重命Group列
pc1 &lt;-floor(pcoa$values$Relative_eig[1]*100)
pc2 &lt;-floor(pcoa$values$Relative_eig[2]*100)
plotdata$Group &lt;- factor(plotdata$Group)

yf &lt;- plotdata
yd1 &lt;- yf %&gt;% group_by(Group) %&gt;% summarise(Max &#x3D; max(PC1))
yd2 &lt;- yf %&gt;% group_by(Group) %&gt;% summarise(Max &#x3D; max(PC2))
yd1$Max &lt;- yd1$Max + max(yd1$Max)*0.1
yd2$Max &lt;- yd2$Max + max(yd2$Max)*0.1
fit1 &lt;- aov(PC1~Group,data &#x3D; plotdata)
tuk1&lt;-glht(fit1,linfct&#x3D;mcp(Group&#x3D;&quot;Tukey&quot;))
res1 &lt;- cld(tuk1,alpah&#x3D;0.05)
fit2 &lt;- aov(PC2~Group,data &#x3D; plotdata)
tuk2&lt;-glht(fit2,linfct&#x3D;mcp(Group&#x3D;&quot;Tukey&quot;))
res2 &lt;- cld(tuk2,alpah&#x3D;0.05)
test &lt;- data.frame(PC1 &#x3D; res1$mcletters$Letters,PC2 &#x3D; res2$mcletters$Letters,
                   yd1 &#x3D; yd1$Max,yd2 &#x3D; yd2$Max,Group &#x3D; yd1$Group)
test$Group &lt;- factor(test$Group)

p1 &lt;- ggplot(plotdata,aes(Group,PC1)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  geom_text(data &#x3D; test,aes(x &#x3D; Group,y &#x3D; yd1,label &#x3D; PC1),size &#x3D; 7) +
  coord_flip() +
  theme_bw()+
  theme(axis.ticks.length &#x3D; unit(.4,&quot;lines&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.y&#x3D;element_text(size&#x3D;15),
        axis.text.x&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
yrange &lt;- ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range
p1

p3 &lt;- ggplot(plotdata,aes(Group,PC2)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  geom_text(data &#x3D; test,aes(x &#x3D; Group,y &#x3D; yd2,label &#x3D; PC2),
            size &#x3D; 7,color &#x3D; &quot;black&quot;,fontface &#x3D; &quot;bold&quot;) +
  theme_bw()+
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), 
        axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.x&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;15,angle &#x3D; 45,
                                 vjust &#x3D; 1,hjust &#x3D; 1),
        axis.text.y&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
yrange &lt;- ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range
p3 &lt;- p3
p3

p2&lt;-ggplot(plotdata, aes(PC1, PC2)) +
  geom_encircle(aes(fill&#x3D;Group,colour&#x3D;Group),alpha&#x3D;.1, show.legend&#x3D;F,size&#x3D;2,expand&#x3D;0.05)+ #同组阴影底色
  #stat_ellipse(level&#x3D;.6,aes(colour&#x3D;Group))+ #画置信圈,alpha是透明度
  geom_point(aes(fill&#x3D;Group,colour&#x3D;Group),size&#x3D;5,pch &#x3D;21, stroke&#x3D;2, alpha&#x3D;.8)+ #点
  #geom_text(aes(label &#x3D; Mark), size &#x3D; 3)+
  xlab(paste0(&quot;PC1 ( &quot;,pc1,&quot;%&quot;,&quot; )&quot;)) + 
  ylab(paste0(&quot;PC2 ( &quot;,pc2,&quot;%&quot;,&quot; )&quot;))+
  xlim(ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range) +
  ylim(ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range) +
  theme(text&#x3D;element_text(size&#x3D;18))+
  geom_vline(aes(xintercept &#x3D; 0),linetype&#x3D;&quot;dotted&quot;)+
  geom_hline(aes(yintercept &#x3D; 0),linetype&#x3D;&quot;dotted&quot;)+
  theme_classic()+
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;3),
        axis.title.y&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;-1),
        axis.text&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;14),
        legend.title&#x3D;element_text(size &#x3D; 14),
        legend.text&#x3D;element_text(size&#x3D;12),
        legend.key&#x3D;element_blank(),legend.position &#x3D; c(1, 1),legend.justification &#x3D; c(1,1),
        legend.background &#x3D; element_rect(colour &#x3D; &quot;black&quot;,fill&#x3D;alpha(&quot;white&quot;,0.4)),
        )
p2

otu.adonis&#x3D;adonis2(data~groups[[paste0(Legend_column)]],data &#x3D; groups,distance &#x3D; method)
p4 &lt;- ggplot(plotdata, aes(PC1, PC2)) +
  geom_text(aes(x &#x3D; -0.5,y &#x3D; 0.6,label &#x3D; paste(output_url,&quot;\ndf &#x3D; &quot;,otu.adonis$Df[1],  &quot;\nR² &#x3D; &quot;,round(otu.adonis$R2[1],4),  &quot;\nP-value &#x3D; &quot;,otu.adonis$&#96;Pr(&gt;F)&#96;[1],sep &#x3D; &quot;&quot;)),
            size &#x3D; 5,family&#x3D;&quot;serif&quot;) +
  theme_bw() +
  xlab(&quot;&quot;) + ylab(&quot;&quot;) +
  theme(panel.grid&#x3D;element_blank(), 
        axis.title &#x3D; element_blank(),
        axis.line &#x3D; element_blank(),
        axis.ticks &#x3D; element_blank(),
        axis.text &#x3D; element_blank())
p4
p5 &lt;- p1 + p4 + p2 + p3 + 
  plot_layout(heights &#x3D; c(1,4),widths &#x3D; c(4,1),ncol &#x3D; 2,nrow &#x3D; 2)
p5

# info &lt;- paste0(&quot;【数据】选用&quot;,unlist(strsplit(data_url, &quot;-&quot;))[1],&quot;压强为&quot;,paste(unique(groups$Pressure),collapse &#x3D;&quot;、&quot;),&quot;第&quot;,paste(unique(groups$Generation),collapse &#x3D;&quot;、&quot;),&quot;代，营养浓度&quot;,paste(unique(groups$Nutrition),collapse &#x3D;&quot;、&quot;),&quot;的数据样本。\n&quot;,&quot;【结论】&quot;,Legend_column,&quot;对于本样本有一定影响。&quot;,&quot;\n【说明】P值&lt;0.05时说明不同组间差异显著。R²越大说明分组对差异的解释度越高。\n\tGalaxy32使用UPARSE方法，Galaxy33使用DADA2方法。&quot;)
# library(showtext)
# library(Cairo)
# library(stringr)
# font_add(&quot;STSong&quot;,&quot;STSONG.TTF&quot;)
# showtext_auto(enable&#x3D;T)
# p2 &lt;- p2+labs(caption &#x3D; info)+
#   theme(plot.caption &#x3D; element_text(size&#x3D;15, family&#x3D;&quot;STSong&quot;,hjust&#x3D;0,vjust&#x3D;3,lineheight&#x3D;1.25))
# p2
# p5 &lt;- p1 + p4 + p2 + p3 + 
#   plot_layout(heights &#x3D; c(1,4),widths &#x3D; c(4,1),ncol &#x3D; 2,nrow &#x3D; 2)
# p5

ggsave(paste0(output_url,&#39;.pdf&#39;), p5, width &#x3D; 12, height &#x3D;12&#x2F;sqrt(2))
print (&quot;end&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-R" data-language="R"><div class="caption"><span>nmds_bray&jaccard.R</span></div><code class="language-R">library(vegan)
library(ape)
library(ggplot2)
library(grid)
library(ggalt)
library(dplyr)
library(multcomp)
library(patchwork)
library(xlsx)
rm(list &#x3D; ls())

galaxy &lt;- &quot;33&quot;
method &lt;-&quot;jaccard&quot; #https:&#x2F;&#x2F;rdocumentation.org&#x2F;packages&#x2F;vegan&#x2F;versions&#x2F;2.6-4&#x2F;topics&#x2F;vegdist #bray jaccard

groups &lt;- read.xlsx2(&quot;Group3233.xlsx&quot;, sheetName &#x3D;galaxy, row.names&#x3D;1)
Legend_column &lt;- &quot;Group&quot; #分组依据是csv中的哪一列
output_url &lt;- paste0(&quot;Galaxy&quot;,galaxy,&quot;-NMDS-&quot;,method)
data &#x3D; read.table(paste0(&quot;Galaxy&quot;,galaxy,&quot;.csv&quot;), header&#x3D;T, row.names&#x3D;1, sep&#x3D;&quot;,&quot;)
data&#x3D;t(data)#每行为一个样品

#在otu和gp中删除Legend_column为空的行
# empty_rows &lt;- which( (is.na(groups[[paste0(Legend_column)]])) | (groups[[paste0(Legend_column)]]&#x3D;&#x3D;&quot;&quot;) )
# groups &lt;- groups[-empty_rows,]
# data &lt;- data[-empty_rows,]
# rm(empty_rows)
# groups&#x3D;subset(groups, select &#x3D; c(paste0(Legend_column),&quot;Mark&quot;))#只保留所需列

#只保留某些mark，此段代码选择启用
# rows &lt;- c(&quot;G52&quot;,&quot;C52&quot;,&quot;Raw&quot;)
# remain_rows &lt;- which( groups[[&quot;Mark&quot;]] %in% rows )
# groups &lt;- groups[remain_rows,]
# data &lt;- data[remain_rows,]
# rm(remain_rows)

data &lt;- vegdist(data, method &#x3D; method)
nmds &lt;- metaMDS(data, distance &#x3D; method, k &#x3D; 2)
NMDS1 &#x3D; nmds$points[,1]
NMDS2 &#x3D; nmds$points[,2]

# 创建包含NMDS坐标和分组信息的数据框架
plotdata &lt;- data.frame(sample&#x3D;rownames(nmds$points), NMDS1, NMDS2, groups)
colnames(plotdata)[1:3] &lt;- c(&quot;sample&quot;,&quot;NMDS1&quot;,&quot;NMDS2&quot;) # 重命名1~3列
names(plotdata)[names(plotdata) &#x3D;&#x3D; paste0(Legend_column)] &lt;- &#39;Group&#39; # 重命Group列
plotdata$Group &lt;- factor(plotdata$Group)

p1 &lt;- ggplot(plotdata, aes(Group, NMDS1)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  coord_flip() +
  theme_bw() +
  theme(axis.ticks.length &#x3D; unit(.4,&quot;lines&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.y&#x3D;element_text(size&#x3D;15),
        axis.text.x&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
p1

p3 &lt;- ggplot(plotdata, aes(Group, NMDS2)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  theme_bw() +
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), 
        axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.x&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;15,angle &#x3D; 45,
                                 vjust &#x3D; 1,hjust &#x3D; 1),
        axis.text.y&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
p3

p2 &lt;- ggplot(plotdata, aes(NMDS1, NMDS2)) +
  geom_point(aes(fill&#x3D;Group,color&#x3D;Group), size&#x3D;5, pch &#x3D; 21, stroke&#x3D;2, alpha&#x3D;.8) +
  #geom_encircle(aes(fill&#x3D;sample_data(ps)$Group,colour&#x3D;sample_data(ps)$Group),alpha&#x3D;.1, show.legend&#x3D;F,size&#x3D;2,expand&#x3D;0.05)+ #同组阴影底色
  stat_ellipse(level&#x3D;.8,aes(colour&#x3D;Group))+ #画置信圈,alpha是透明度
  xlab(&quot;NMDS 1&quot;) + 
  ylab(&quot;NMDS 2&quot;) +
  theme_classic() +
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;3),
        axis.title.y&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;-1),
        axis.text&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;14),
        legend.title&#x3D;element_text(size &#x3D; 14),
        legend.text&#x3D;element_text(size&#x3D;12),
        legend.key&#x3D;element_blank(),legend.position &#x3D; c(1, 1),legend.justification &#x3D; c(1,1),
        legend.background &#x3D; element_rect(colour &#x3D; &quot;black&quot;,fill&#x3D;alpha(&quot;white&quot;,0.4)),
  )
p2


otu.adonis &lt;- adonis2(data ~ groups[[paste0(Legend_column)]], data &#x3D; groups, distance &#x3D; method)
p4 &lt;- ggplot(plotdata, aes(PC1, PC2)) +
  geom_text(aes(x &#x3D; -0.5,y &#x3D; 0.6,label &#x3D; paste(output_url,&quot;\ndf &#x3D; &quot;,otu.adonis$Df[1],  &quot;\nR² &#x3D; &quot;,round(otu.adonis$R2[1],4),  &quot;\nP-value &#x3D; &quot;,otu.adonis$&#96;Pr(&gt;F)&#96;[1],sep &#x3D; &quot;&quot;)),
            size &#x3D; 5,family&#x3D;&quot;serif&quot;) +
  theme_bw() +
  xlab(&quot;&quot;) + ylab(&quot;&quot;) +
  theme(panel.grid&#x3D;element_blank(), 
        axis.title &#x3D; element_blank(),
        axis.line &#x3D; element_blank(),
        axis.ticks &#x3D; element_blank(),
        axis.text &#x3D; element_blank())
p4
p5 &lt;- p1 + p4 + p2 + p3 + 
  plot_layout(heights &#x3D; c(1,4),widths &#x3D; c(4,1),ncol &#x3D; 2,nrow &#x3D; 2)
p5

# info &lt;- paste0(&quot;【数据】选用&quot;,unlist(strsplit(data_url, &quot;-&quot;))[1],&quot;压强为&quot;,paste(unique(groups$Pressure),collapse &#x3D;&quot;、&quot;),&quot;第&quot;,paste(unique(groups$Generation),collapse &#x3D;&quot;、&quot;),&quot;代，营养浓度&quot;,paste(unique(groups$Nutrition),collapse &#x3D;&quot;、&quot;),&quot;的数据样本。\n&quot;,&quot;【结论】&quot;,Legend_column,&quot;对于本样本有一定影响。&quot;,&quot;\n【说明】P值&lt;0.05时说明不同组间差异显著。R²越大说明分组对差异的解释度越高。\n\tGalaxy32使用UPARSE方法，Galaxy33使用DADA2方法。&quot;)
# library(showtext)
# library(Cairo)
# library(stringr)
# font_add(&quot;STSong&quot;,&quot;STSONG.TTF&quot;)
# showtext_auto(enable&#x3D;T)
# p2 &lt;- p2+labs(caption &#x3D; info)+
#   theme(plot.caption &#x3D; element_text(size&#x3D;15, family&#x3D;&quot;STSong&quot;,hjust&#x3D;0,vjust&#x3D;3,lineheight&#x3D;1.25))
# p2
# p5 &lt;- p1 + p4 + p2 + p3 + 
#   plot_layout(heights &#x3D; c(1,4),widths &#x3D; c(4,1),ncol &#x3D; 2,nrow &#x3D; 2)
# p5

ggsave(paste0(output_url,&#39;.pdf&#39;), p5, width &#x3D; 12, height &#x3D;12&#x2F;sqrt(2))
print (&quot;end&quot;)
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="基于系统发生树">基于系统发生树</h2><pre class="line-numbers language-R" data-language="R"><div class="caption"><span>nmds_unifrac.R</span></div><code class="language-R">rm(list &#x3D; ls())
library(phyloseq)
library(vegan)
library(ggalt)
library(ggplot2)
library(ape)
library(xlsx)
library(patchwork)
tree &lt;- read.tree(&quot;G33-Galaxy51-[FastTree.nwk].nwk&quot;)

# 读取分组文件
Group &lt;- read.xlsx2(&quot;Group3233.xlsx&quot;, sheetName &#x3D;&quot;33&quot;, row.names&#x3D;1)

# 读取物种丰度表，假设文件名为otu_table.csv
otu_url &lt;- &quot;Galaxy33-[DADA2_OTU_table].csv&quot;
otu &lt;- read.csv(otu_url, row.names &#x3D; 1)

method &lt;- &quot;wunifrac&quot; #wunifrac unifrac

output_url&lt;-paste0(unlist(strsplit(otu_url, &quot;-&quot;))[1],&quot;-NMDS-&quot;,method)

# 构建phyloseq对象
ps &lt;- phyloseq(otu_table(as.matrix(otu), taxa_are_rows &#x3D; TRUE),
               sample_data(Group),
               phy_tree(tree))


# 从phyloseq对象中提取元数据
meta &lt;- as.data.frame(sample_data(ps))

# 计算加权UniFrac距离矩阵
dist_matrix &lt;- as.matrix(distance(ps, method &#x3D; method))

# 计算NMDS
nmds &lt;- metaMDS(dist_matrix, distance &#x3D; method, k &#x3D; 2)
# 将NMDS结果转换为数据框架
nmds_df &lt;- as.data.frame(nmds$points)
meta &lt;- as.data.frame(sample_data(ps))
otu.adonis &lt;- adonis2(dist_matrix ~ Group, data&#x3D;Group)

NMDS1 &#x3D; nmds$points[,1]
NMDS2 &#x3D; nmds$points[,2]
plotdata &lt;- data.frame(sample&#x3D;rownames(nmds$points), NMDS1, NMDS2, Group&#x3D;meta$Group)
plotdata$Group &lt;- factor(plotdata$Group) # 确保分组变量是因子类型

p1 &lt;- ggplot(plotdata,aes(Group,NMDS1)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  coord_flip() +
  theme_bw()+
  theme(axis.ticks.length &#x3D; unit(.4,&quot;lines&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.y&#x3D;element_text(size&#x3D;15),
        axis.text.x&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
yrange &lt;- ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range
p1


p3 &lt;- ggplot(plotdata,aes(Group,NMDS2)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  theme_bw()+
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), 
        axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.x&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;15,angle &#x3D; 45,
                                 vjust &#x3D; 1,hjust &#x3D; 1),
        axis.text.y&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
yrange &lt;- ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range
p3


# 使用ggplot2包进行绘图
p2&lt;-ggplot(nmds_df, aes(MDS1, MDS2, color &#x3D; meta$Group)) +
  labs(color &#x3D; &quot;Group&quot;,fill&#x3D;&quot;Group&quot;)+
  #geom_encircle(aes(fill&#x3D;sample_data(ps)$Group,colour&#x3D;sample_data(ps)$Group),alpha&#x3D;.1, show.legend&#x3D;F,size&#x3D;2,expand&#x3D;0.05)+ #同组阴影底色
  stat_ellipse(level&#x3D;.8,aes(colour&#x3D;sample_data(ps)$Group))+ #画置信圈,alpha是透明度
  geom_point(aes(fill&#x3D;sample_data(ps)$Group,colour&#x3D;sample_data(ps)$Group),size&#x3D;5,pch &#x3D;21, stroke&#x3D;2, alpha&#x3D;.8)+ #点
  #geom_text(aes(label &#x3D; Mark), size &#x3D; 3)+
  xlab(&quot;NMDS 1&quot;) + 
  ylab(&quot;NMDS 2&quot;)+
  xlim(ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range) +
  ylim(ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range) +
  theme(text&#x3D;element_text(size&#x3D;18))+
  geom_vline(aes(xintercept &#x3D; 0),linetype&#x3D;&quot;dotted&quot;)+
  geom_hline(aes(yintercept &#x3D; 0),linetype&#x3D;&quot;dotted&quot;)+
  theme_classic()+
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;3),
        axis.title.y&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;-1),
        axis.text&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;14),
        legend.title&#x3D;element_text(size &#x3D; 14),
        legend.text&#x3D;element_text(size&#x3D;12),
        legend.key&#x3D;element_blank(),legend.position &#x3D; c(1, 1),legend.justification &#x3D; c(1,1),
        legend.background &#x3D; element_rect(colour &#x3D; &quot;black&quot;,fill&#x3D;alpha(&quot;white&quot;,0.4)),
  )
p2

p4 &lt;- ggplot(plotdata, aes(PC1, PC2)) +
  geom_text(aes(x &#x3D; -0.5,y &#x3D; 0.6,label &#x3D; paste0(output_url,&quot;\ndf &#x3D; &quot;,otu.adonis$Df[1],  &quot;\nR² &#x3D; &quot;,round(otu.adonis$R2[1],4),  &quot;\nP-value &#x3D; &quot;,otu.adonis$&#96;Pr(&gt;F)&#96;[1],sep &#x3D; &quot;&quot;)),
            size &#x3D; 4.5,family&#x3D;&quot;serif&quot;) +
  theme_bw() +
  xlab(&quot;&quot;) + ylab(&quot;&quot;) +
  theme(panel.grid&#x3D;element_blank(), 
        axis.title &#x3D; element_blank(),
        axis.line &#x3D; element_blank(),
        axis.ticks &#x3D; element_blank(),
        axis.text &#x3D; element_blank())
p4
p5 &lt;- p1 + p4 + p2 + p3 + 
  plot_layout(heights &#x3D; c(1,4),widths &#x3D; c(4,1),ncol &#x3D; 2,nrow &#x3D; 2)
p5

ggsave(paste0(&quot;output&#x2F;&quot;,output_url,&quot;.pdf&quot;), p5, width &#x3D; 12, height &#x3D;12&#x2F;sqrt(2))
print (&quot;end&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-R" data-language="R"><div class="caption"><span>pcoa_unifrac.R</span></div><code class="language-R">rm(list &#x3D; ls())
library(phyloseq)
library(vegan)
library(ggalt)
library(ggplot2)
library(ape)
library(xlsx)
library(patchwork)
tree &lt;- read.tree(&quot;G33-Galaxy51-[FastTree.nwk].nwk&quot;)

# 读取分组文件
Group &lt;- read.xlsx2(&quot;Group3233.xlsx&quot;, sheetName &#x3D;&quot;33&quot;, row.names&#x3D;1)

# 读取物种丰度表，假设文件名为otu_table.csv
otu_url &lt;- &quot;Galaxy33-[DADA2_OTU_table].csv&quot;
otu &lt;- read.csv(otu_url, row.names &#x3D; 1)

method &lt;- &quot;unifrac&quot;

output_url&lt;-paste0(unlist(strsplit(otu_url, &quot;-&quot;))[1],&quot;-PCoA-&quot;,method)

# 构建phyloseq对象
ps &lt;- phyloseq(otu_table(as.matrix(otu), taxa_are_rows &#x3D; TRUE),
               sample_data(Group),
               phy_tree(tree))

# 计算PCoA
pcoa &lt;- ordinate(ps, method &#x3D; &quot;PCoA&quot;, distance &#x3D; method)
PC1 &#x3D; pcoa$vectors[,1]
PC2 &#x3D; pcoa$vectors[,2]
plotdata &lt;- data.frame(rownames(pcoa$vectors),PC1,PC2,Group)
colnames(plotdata)[1:4] &lt;-c(&quot;sample&quot;,&quot;PC1&quot;,&quot;PC2&quot;,&quot;Group&quot;) #重命名1~3列
pc1 &lt;-floor(pcoa$values$Relative_eig[1]*100)
pc2 &lt;-floor(pcoa$values$Relative_eig[2]*100)
plotdata$Group &lt;- factor(plotdata$Group)

dist_matrix &lt;- as.matrix(distance(ps, method &#x3D; method))
meta &lt;- as.data.frame(sample_data(ps))
otu.adonis &lt;- adonis2(dist_matrix ~ Group, data&#x3D;Group)


p1 &lt;- ggplot(plotdata,aes(Group,PC1)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  coord_flip() +
  theme_bw()+
  theme(axis.ticks.length &#x3D; unit(.4,&quot;lines&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.y&#x3D;element_text(size&#x3D;15),
        axis.text.x&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
yrange &lt;- ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range
p1


p3 &lt;- ggplot(plotdata,aes(Group,PC2)) +
  geom_boxplot(aes(fill &#x3D; Group)) +
  theme_bw()+
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), 
        axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_blank(),
        axis.title.y&#x3D;element_blank(),
        axis.text.x&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;15,angle &#x3D; 45,
                                 vjust &#x3D; 1,hjust &#x3D; 1),
        axis.text.y&#x3D;element_blank(),
        legend.position &#x3D; &quot;none&quot;)
yrange &lt;- ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range
p3


# 使用ggplot2包进行绘图
p2&lt;-plot_ordination(ps, pcoa) +
  labs(color &#x3D; &quot;Group&quot;,fill&#x3D;&quot;Group&quot;)+
  #geom_encircle(aes(fill&#x3D;sample_data(ps)$Group,colour&#x3D;sample_data(ps)$Group),alpha&#x3D;.1, show.legend&#x3D;F,size&#x3D;2,expand&#x3D;0.05)+ #同组阴影底色
  stat_ellipse(level&#x3D;.6,aes(colour&#x3D;sample_data(ps)$Group))+ #画置信圈,alpha是透明度
  geom_point(aes(fill&#x3D;sample_data(ps)$Group,colour&#x3D;sample_data(ps)$Group),size&#x3D;5,pch &#x3D;21, stroke&#x3D;2, alpha&#x3D;.8)+ #点
  #geom_text(aes(label &#x3D; Mark), size &#x3D; 3)+
  xlab(paste0(&quot;PC1 ( &quot;,pc1,&quot;%&quot;,&quot; )&quot;)) + 
  ylab(paste0(&quot;PC2 ( &quot;,pc2,&quot;%&quot;,&quot; )&quot;))+
  xlim(ggplot_build(p1)$layout$panel_scales_y[[1]]$range$range) +
  ylim(ggplot_build(p3)$layout$panel_scales_y[[1]]$range$range) +
  theme(text&#x3D;element_text(size&#x3D;18))+
  geom_vline(aes(xintercept &#x3D; 0),linetype&#x3D;&quot;dotted&quot;)+
  geom_hline(aes(yintercept &#x3D; 0),linetype&#x3D;&quot;dotted&quot;)+
  theme_classic()+
  theme(axis.ticks.length &#x3D; unit(0.4,&quot;lines&quot;), axis.ticks &#x3D; element_line(color&#x3D;&#39;black&#39;),
        axis.line &#x3D; element_line(colour &#x3D; &quot;black&quot;), 
        axis.title.x&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;3),
        axis.title.y&#x3D;element_text(colour&#x3D;&#39;black&#39;, size&#x3D;18,vjust&#x3D;-1),
        axis.text&#x3D;element_text(colour&#x3D;&#39;black&#39;,size&#x3D;14),
        legend.title&#x3D;element_text(size &#x3D; 14),
        legend.text&#x3D;element_text(size&#x3D;12),
        legend.key&#x3D;element_blank(),legend.position &#x3D; c(1, 1),legend.justification &#x3D; c(1,1),
        legend.background &#x3D; element_rect(colour &#x3D; &quot;black&quot;,fill&#x3D;alpha(&quot;white&quot;,0.4)),
  )
p2


dist_matrix &lt;- as.matrix(distance(ps, method &#x3D; method))
# 从phyloseq对象中提取元数据
meta &lt;- as.data.frame(sample_data(ps))
# 进行ADONIS分析
otu.adonis &lt;- adonis2(dist_matrix ~ Group, data&#x3D;Group)

p4 &lt;- ggplot(plotdata, aes(PC1, PC2)) +
  geom_text(aes(x &#x3D; -0.5,y &#x3D; 0.6,label &#x3D; paste(output_url,&quot;\ndf &#x3D; &quot;,otu.adonis$Df[1],  &quot;\nR² &#x3D; &quot;,round(otu.adonis$R2[1],4),  &quot;\nP-value &#x3D; &quot;,otu.adonis$&#96;Pr(&gt;F)&#96;[1],sep &#x3D; &quot;&quot;)),
            size &#x3D; 4.5,family&#x3D;&quot;serif&quot;) +
  theme_bw() +
  xlab(&quot;&quot;) + ylab(&quot;&quot;) +
  theme(panel.grid&#x3D;element_blank(), 
        axis.title &#x3D; element_blank(),
        axis.line &#x3D; element_blank(),
        axis.ticks &#x3D; element_blank(),
        axis.text &#x3D; element_blank())
p4
p5 &lt;- p1 + p4 + p2 + p3 + 
  plot_layout(heights &#x3D; c(1,4),widths &#x3D; c(4,1),ncol &#x3D; 2,nrow &#x3D; 2)
p5

ggsave(paste0(&quot;output\&quot;,output_url,&#39;.pdf&#39;), p5, width &#x3D; 12, height &#x3D;12&#x2F;sqrt(2))
print (&quot;end&quot;)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><link rel="stylesheet" type="text/css" href="/css/hint.min.css"></article><hr class="end_hr"><div class="reprint"><p><span class="reprint-tip"><i class="fa fa-exclamation-circle"></i> 本文为博主原创。转载请注明: </span><a href="https://lzc2002.top" class="b-link-green">lzc的小站</a> <i class="fa fa-angle-right fa-lg fa-fw text-color"></i> <a href="/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/" class="b-link-green">R语言分析α、β多样性</a>。<a style="color:var(--LightGrey);text-decoration:underline" href="mailto:i@lzc2002.top?subject=版权问题&body=我在你站文章《R语言分析α、β多样性》里遇到了版权问题。">原创声明举报</a></p></div><div id="reward" class="app1"><a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-medium waves-effect waves-light">赏</a><div id="rewardModal" class="modal"><div class="modal-content"><a class="close modal-close"><i class="fas fa-times"></i></a><h4 class="reward-title">感谢您的赏识</h4><div class="reward-content"><div class="reward-tabs"><ul class="tabs row"><li class="tab wechat-tab waves-effect waves-light"><a class="active" href="#wechat">微信</a></li><li class="tab alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li><li class="tab alihongbao-tab waves-effect waves-light"><a href="#alihongbao">看广告</a></li></ul><div id="wechat"><img src="/medias/reward/wechat.png" class="reward-img" alt="微信打赏二维码"></div><div id="alipay"><p>建议先扫红包码。</p><img src="/medias/reward/alihongbao.png" class="reward-img" alt="支付宝红包码"> <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码"></div><div id="alihongbao"><p><a onclick="ad2345()">关于广告</a></p></div></div><a href="/reward.html" style="padding-bottom:15px">查看赞赏及支出记录</a></div></div></div></div><script>$(function(){$(".tabs").tabs()})</script><link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css"><div id="article-share" class="hide-on-small-only"><div class="social-share" data-disabled="qzone, qq, weibo, douban"></div></div><script src="/libs/share/js/social-share.min.js"></script><script>window.onload=function(){/(iPhone|iPad|iPod|iOS|Android)/i.test(navigator.userAgent)&&$("#article-share").hide()}</script></div></div><link rel="preconnect" href="https://apis.map.qq.com"><link rel="stylesheet" href="/libs/valine/valine-my.css" type="text/css"><div id="comments" class="card valine-card" style="margin-top:auto" data-aos="fade-up"><div style="overflow:hidden" class="card-content article-card-content"><h3 id="comments-title">发表您的看法</h3><div id="vcomments"><b>加载失败，请刷新页面。若该问题持续出现，则可能是评论区被禁用。</b></div></div></div><script src="/libs/valine/av-min.js"></script><script src="/libs/valine/iife.min.js"></script><script src="/libs/valine/Valine.min.js"></script><script>let placeholdertext;placeholdertext='推心置腹的谈话就是心灵的展示。——温·卡维林\n（本评论区无需登录，友善的评论是交流的起点！）';new Valine({el:'#vcomments',appId:'KKXPJIC2tKhiht5uCdmFR6R0-gzGzoHsz',appKey:'3C6HL2hRYTdga856HYn4V1Sw',meta:['nick','mail'],visitor:'true'==='true',recordIP:'true'==='true',avatar:'mp',pageSize:'10',lang:'en',placeholder:placeholdertext,enableQQ:'true',lang:'zh-CN',serverURLs:'https://leancloudcn.lzc2002.top'});</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fa fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/2024/0331/folder-accumulation/individual-society/taking-risks/"><div class="card-image"><img src="https://source.unsplash.com/uKlneQRwaxY/750x350" class="responsive-img" alt="Taking Risks"> <span class="card-title">Taking Risks</span></div></a><div class="card-content article-content"><div class="summary">IELTS Task 17-1</div><div class="publish-info"><span class="publish-date"><a href="/tags/%E5%B9%B2%E8%B4%A7/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>干货 </a><a href="/tags/%E5%89%91%E9%9B%85/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>剑雅 </a></span><span class="publish-author"><span class="article-tags"><a href="/categories/Writing/" target="_blank"><span class="chip bg-color">Writing</span> </a><a href="/categories/Writing/Topics/" target="_blank"><span class="chip bg-color">Topics</span> </a><a href="/categories/Writing/Topics/Individual-Society/" target="_blank"><span class="chip bg-color">Individual &amp; Society</span></a></span></span></div></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fa fa-chevron-right"></i></div><div class="card"><a href="/2024/0312/folder-accumulation/gov/prioritizing-economy/"><div class="card-image"><img src="https://source.unsplash.com/8lnbXtxFGZw/750x350" class="responsive-img" alt="Prioritizing Economy"> <span class="card-title">Prioritizing Economy</span></div></a><div class="card-content article-content"><div class="summary">IELTS 11 Task 4</div><div class="publish-info"><span class="publish-date"><a href="/tags/%E5%B9%B2%E8%B4%A7/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>干货 </a><a href="/tags/%E5%89%91%E9%9B%85/" class="post-tag" target="_blank"><i class="fas fa-hashtag"></i>剑雅 </a></span><span class="publish-author"><span class="article-tags"><a href="/categories/Writing/" target="_blank"><span class="chip bg-color">Writing</span> </a><a href="/categories/Writing/Topics/" target="_blank"><span class="chip bg-color">Topics</span></a></span></span></div></div></div></div></div></article></div><style>.article-info .col.s6{width:100%}</style><script defer type="text/javascript" src="/libs/codeBlock/codeBlockFunction.js"></script><script defer type="text/javascript" src="/libs/codeBlock/codeLang.js"></script><script defer type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script><script defer type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script><script src="/libs/s2t/jquery.s2t.js"></script><script>MPost.search_author("","https://proxy1.lzc2002.top/http/https://zh.wikipedia.org")</script></div><div class="col l3 hide-on-med-and-down" id="pagetoc"><div class="toc-widget"><div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div><a id="toc-content" class="toc-content" href="javascript:MPost.toc_init();">点击加载目录</a></div></div></div><div id="floating-toc-btn" onclick="toggletoc()"><a class="btn-floating btn-large bg-color waves-effect waves-light"><i class="fa fa-list"></i></a></div></main><footer class="page-footer bg-color"><div class="container row center-align"><div class="col s12 m8 l8 copy-right"><div class="footerCDN app1 hide-on-small-only"><b><a class="footerCDN inlineSpan" href="https://www.lzc2002.top/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/"><svg t="1651370553750" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1782" width="200" height="200"><path d="M512 96l480 832H32z" p-id="1783"></path></svg> 线路1(推荐) </a></b><a class="footerCDN inlineSpan" href="https://lzctuhao.4everland.app/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/"><img src="/medias/icons/4everland.png" alt="4everland"> <svg t="1651370711138" class="icon" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16776" width="200" height="200"><path d="M815.812 639.826l-461.6-5.856a9.16 9.16 0 0 1-7.264-3.852 9.296 9.296 0 0 1-0.988-8.294 12.286 12.286 0 0 1 10.722-8.152l465.88-5.872c55.262-2.52 115.092-47.148 136.044-101.568l26.572-69.084a15.888 15.888 0 0 0 1.048-5.872 15.47 15.47 0 0 0-0.328-3.262A303.82 303.82 0 0 0 402.514 396.8 136.24 136.24 0 0 0 188.4 539.18C83.848 542.212 0 627.456 0 732.24a192.108 192.108 0 0 0 2.058 27.916 9.016 9.016 0 0 0 8.89 7.742l852.2 0.102c0.086 0 0.16-0.038 0.244-0.04a11.212 11.212 0 0 0 10.542-8l6.546-22.53c7.8-26.8 4.896-51.6-8.2-69.8-12.032-16.784-32.1-26.656-56.468-27.804z m211.9-197.626c-4.282 0-8.542 0.124-12.782 0.328a7.542 7.542 0 0 0-6.648 5.306l-18.154 62.386c-7.8 26.8-4.898 51.572 8.2 69.78 12.04 16.8 32.108 26.646 56.476 27.8l98.4 5.878a8.982 8.982 0 0 1 7.02 3.788 9.28 9.28 0 0 1 1.028 8.338 12.306 12.306 0 0 1-10.702 8.15l-102.25 5.878c-55.508 2.54-115.338 47.148-136.29 101.568l-7.39 19.212a5.432 5.432 0 0 0 4.854 7.36c0.092 0 0.176 0.034 0.272 0.034h351.82a9.38 9.38 0 0 0 9.078-6.74 249.614 249.614 0 0 0 9.364-68C1280 554.6 1167.048 442.2 1027.712 442.2z" p-id="16777"></path></svg> 线路2 </a><a class="footerCDN inlineSpan" href="https://lzc.vercel.app/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/"><svg t="1651370553750" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1782" width="200" height="200"><path d="M512 96l480 832H32z" p-id="1783"></path></svg> 线路3 </a><a class="footerCDN inlineSpan" href="https://lzc2002.netlify.app/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/"><svg t="1651370594034" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="15624" width="200" height="200"><path d="M722.517333 363.477333a44.544 44.544 0 0 1 12.928 9.813334l100.224-44.586667-93.525333-92.629333-20.949333 126.037333zM514.56 279.296a55.68 55.68 0 0 1 8.917333 24.490667l149.205334 63.232a44.544 44.544 0 0 1 15.146666-7.552l24.490667-151.466667-90.88-95.317333-106.88 164.352v2.261333z m509.141333 234.282667l-159.914666-159.914667-108.714667 44.544 267.264 113.578667s2.261333 1.792 1.365333 1.792z m-26.752 25.856l-256.554666-109.610667a44.544 44.544 0 0 1-29.866667 17.365333l-27.605333 168.832a44.544 44.544 0 0 1 12.928 31.189334l155.008 32.512 142.08-141.226667v-2.645333zM657.066667 394.666667l-139.434667-59.306667a51.2 51.2 0 0 1-44.544 23.168h-8.490667L349.226667 536.746667l308.266666-133.632v0.426666a37.845333 37.845333 0 0 1 0-7.125333 2.218667 2.218667 0 0 0-0.426666-1.749333z m169.258666 311.808l-136.32-28.074667a46.762667 46.762667 0 0 1-19.626666 14.677333l-32.469334 201.386667 189.312-187.562667s-0.426667 0.853333-0.896 0.853334z m-190.677333-13.824a44.544 44.544 0 0 1-26.282667-30.293334l-253.866666-52.138666-3.584 5.802666 230.314666 333.226667 13.781334-13.824 39.210666-241.92s1.322667 0.938667 0.426667 0.469333z m-274.816-113.152l250.794667 51.669333a44.544 44.544 0 0 1 35.157333-22.272l27.178667-166.144-5.76-4.906667-311.808 133.632a77.525333 77.525333 0 0 1 4.437333 8.021334z m-105.130667 41.856l-5.333333-5.333334-108.245333 44.544 52.565333 52.138667 59.690667-92.672z m71.253334 16.938666a58.368 58.368 0 0 1-24.021334 5.333334 59.264 59.264 0 0 1-19.2-3.114667l-65.877333 95.786667 288.64 285.952 50.773333-50.346667z m-40.533334-112.682666a72.618667 72.618667 0 0 1 13.397334 0 58.794667 58.794667 0 0 1 14.677333 0l116.693333-181.333334a50.773333 50.773333 0 0 1-14.250666-35.157333 52.992 52.992 0 0 1 0-11.562667l-141.653334-65.493333-114.005333 110.933333z m12.928-315.818667l138.112 58.794667a52.992 52.992 0 0 1 35.626667-12.032 57.898667 57.898667 0 0 1 16.938667 2.688l107.776-168.405334L508.714667 1.749333 299.349333 207.104s-0.426667 2.218667 0 2.688z m-51.626666 348.330667a66.816 66.816 0 0 1 10.24-14.250667L139.861333 367.488 0 503.338667l247.637333 54.784z m-11.178667 29.866666L22.741333 543.36l93.994667 95.36 118.485333-50.346667z" p-id="15625"></path></svg> 线路4 </a><span class="inlineSpan"><a class="footerCDN inlineSpan" href="https://gh.lzc2002.gq/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/"><svg t="1651370627500" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16590" width="200" height="200"><path d="M511.957333 21.333333C241.024 21.333333 21.333333 240.981333 21.333333 512c0 216.832 140.544 400.725333 335.573334 465.664 24.490667 4.394667 32.256-10.069333 32.256-23.082667 0-11.690667 0.256-44.245333 0-85.205333-136.448 29.610667-164.736-64.64-164.736-64.64-22.314667-56.704-54.4-71.765333-54.4-71.765333-44.586667-30.464 3.285333-29.824 3.285333-29.824 49.194667 3.413333 75.178667 50.517333 75.178667 50.517333 43.776 75.008 114.816 53.333333 142.762666 40.789333 4.522667-31.658667 17.152-53.376 31.189334-65.536-108.970667-12.458667-223.488-54.485333-223.488-242.602666 0-53.546667 19.114667-97.322667 50.517333-131.669334-5.034667-12.330667-21.930667-62.293333 4.778667-129.834666 0 0 41.258667-13.184 134.912 50.346666a469.802667 469.802667 0 0 1 122.88-16.554666c41.642667 0.213333 83.626667 5.632 122.88 16.554666 93.653333-63.488 134.784-50.346667 134.784-50.346666 26.752 67.541333 9.898667 117.504 4.864 129.834666 31.402667 34.346667 50.474667 78.122667 50.474666 131.669334 0 188.586667-114.730667 230.016-224.042666 242.090666 17.578667 15.232 33.578667 44.672 33.578666 90.453334v135.850666c0 13.141333 7.936 27.605333 32.853334 22.869334C862.250667 912.597333 1002.666667 728.746667 1002.666667 512 1002.666667 240.981333 783.018667 21.333333 511.957333 21.333333z" p-id="16591"></path></svg> 线路5 </a><a class="footerCDN inlineSpan" href="https://www.lzc2002.gq/2024/0314/folder-education/folder-innovativeentrepreneurialtraining/r-alpha-beta/"><img src="/medias/icons/4everland.png" alt="4everland"> <svg t="1651370711138" class="icon" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="16776" width="200" height="200"><path d="M815.812 639.826l-461.6-5.856a9.16 9.16 0 0 1-7.264-3.852 9.296 9.296 0 0 1-0.988-8.294 12.286 12.286 0 0 1 10.722-8.152l465.88-5.872c55.262-2.52 115.092-47.148 136.044-101.568l26.572-69.084a15.888 15.888 0 0 0 1.048-5.872 15.47 15.47 0 0 0-0.328-3.262A303.82 303.82 0 0 0 402.514 396.8 136.24 136.24 0 0 0 188.4 539.18C83.848 542.212 0 627.456 0 732.24a192.108 192.108 0 0 0 2.058 27.916 9.016 9.016 0 0 0 8.89 7.742l852.2 0.102c0.086 0 0.16-0.038 0.244-0.04a11.212 11.212 0 0 0 10.542-8l6.546-22.53c7.8-26.8 4.896-51.6-8.2-69.8-12.032-16.784-32.1-26.656-56.468-27.804z m211.9-197.626c-4.282 0-8.542 0.124-12.782 0.328a7.542 7.542 0 0 0-6.648 5.306l-18.154 62.386c-7.8 26.8-4.898 51.572 8.2 69.78 12.04 16.8 32.108 26.646 56.476 27.8l98.4 5.878a8.982 8.982 0 0 1 7.02 3.788 9.28 9.28 0 0 1 1.028 8.338 12.306 12.306 0 0 1-10.702 8.15l-102.25 5.878c-55.508 2.54-115.338 47.148-136.29 101.568l-7.39 19.212a5.432 5.432 0 0 0 4.854 7.36c0.092 0 0.176 0.034 0.272 0.034h351.82a9.38 9.38 0 0 0 9.078-6.74 249.614 249.614 0 0 0 9.364-68C1280 554.6 1167.048 442.2 1027.712 442.2z" p-id="16777"></path></svg> 线路6</a></span><br></div><div>本站由 Cheuksing 基于 Hexo 搭建</div><div id="beian" class="beian_all"><a target="_blank" href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44011502001113" class="beian mps"><img src="/medias/icons/beian.png"><span>粤公网安备 44011502001113号</span></a> <span style="width:15px"></span> <a target="_blank" href="https://beian.miit.gov.cn/" class="beian web"><span class="inlineSpan">粤ICP备2023073334号-1</span></a> <span style="width:15px"></span> <a target="_blank" href="https://beian.miit.gov.cn/" class="beian androidapp"><span class="inlineSpan">粤ICP备2023073334号-2A</span></a> <span style="width:15px"></span> <a target="_blank" href="https://appgallery.huawei.com/app/C107620695" class="beian quickapp"><span class="inlineSpan">粤ICP备2023073334号-3K</span></a></div></div><div class="col s12 m4 l4 social-link"><a href="mailto:lzctuhao@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope"></i> </a><a href="https://twitter.com/lzctuhao" class="tooltipped" target="_blank" data-tooltip="Twitter ID: lzctuhao" data-position="top" data-delay="50"><i class="fab fa-twitter"></i> </a><a href="/rss.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50"><i class="fa fa-rss"></i> </a><a href="javascript:;" class="tooltipped" data-tooltip="微信公众号：<b>lzc的碎碎念</b>" data-position="top" data-delay="50" onclick="wechat_account()"><i class="fab fa-weixin"></i></a></div></div></footer><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input" disabled></div><div id="searchLoading"><img src="/medias/loading/loading-dna.svg" attribute="loading" alt="搜索索引正在加载中"><div>搜索索引正在加载中</div></div><div id="searchResult"></div></div></div><script src="/js/search.js"></script><div id="backTop" class="top-scroll" title="回顶部"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-angle-double-up"></i></a></div><script src="/libs/masonry/masonry.pkgd.min.js"></script><script src="/libs/scrollprogress/scrollProgress.min.js"></script></body></html>